"use strict";function _toArray(a){return Array.isArray(a)?a:Array.from(a)}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var _module=angular.module("sto-exotics-card",[]);_module.directive("card",function(){return{scope:{current:"=",item:"=",add:"=",remove:"="},templateUrl:"card.html",transclude:!0,link:function(a,b,c){a.range=function(a,b){for(var c=[],d=a;d<=b;d++)c.push(d);return c},a.isNumber=function(a){return"number"==typeof a},a.showCategory="showCategory"in c}}});var _module=angular.module("sto-exotics-data",[]);_module.factory("exoticsData",function(){var a=function(a){return((60==a?2.88:0)+a)/49},b=function(a){return.5*a/100+.5},c=function(a){return.2*a/75+.333},d=function(a){return.1*a/11+1/11},e={abilities:[{name:"Destabilizing Resonance Beam",career:"Science",baseDamage:120,damageType:"Physical",rankModifiers:[0,.275,.55],icon:"Destabilizing_Resonance_Beam_icon_(Federation)",auxScaling:function(a){return.65*a/75+.333}},{name:"Feedback Pulse",career:"Science",baseDamage:.33,damageType:"Incoming Energy",rankModifiers:[0,1/3,2/3],epgCategory:"cat1",icon:"Feedback_Pulse_icon_(Federation)",levelScaling:function(a){return 0},damagePrecision:2},{name:"Gravity Well",career:"Science",baseDamage:372.96,damageType:"Kinetic",rankModifiers:[0,1/3,.66625],epgCategory:"cat1",icon:"Gravity_Well_icon_(Federation)",auxScaling:c,isHazard:!0},{name:"Photonic Shockwave",career:"Science",baseDamage:1200,damageType:"Kinetic",rankModifiers:[0,.25,.5],epgCategory:"cat1",icon:"Photonic_Shock_Wave_icon_(Federation)",auxScaling:function(a){return 1}},{name:"Subspace Vortex",career:"Science",baseDamage:720,damageType:"Kinetic",rankModifiers:[0,.3,.6],epgCategory:"cat1",icon:"Subspace_Vortex_icon_(Federation)",auxScaling:c},{name:"Tractor Beam",career:"Science",baseDamage:30,damageType:"Kinetic",rankModifiers:[0,.33,.66],icon:"Tractor_Beam_icon_(Federation)"},{name:"Tractor Beam Repulsors",career:"Science",baseDamage:375,damageType:"Kinetic",rankModifiers:[0,.32,.66],epgCategory:"cat1",icon:"Tractor_Beam_Repulsors_icon_(Federation)",auxScaling:function(a){return 1}},{name:"Tyken's Rift",career:"Science",baseDamage:99,damageType:"Kinetic",rankModifiers:[0,.25,.5],epgCategory:"cat1",icon:"Tyken's_Rift_icon_(Federation)",auxScaling:d,isHazard:!0},{name:"Channeled Deconstruction",career:"Temporal",baseDamage:90,damageRangeMultiplier:3.222222,damageType:"Physical",rankModifiers:[0,.3,.6],epgCategory:"cat1",icon:"Channeled_Deconstruction_icon"},{name:"Entropic Cascade",career:"Temporal",baseDamage:200,damageType:"Physical",rankModifiers:[0,.3,.6],epgCategory:"cat1",icon:"Entropic_Cascade_icon",auxScaling:function(a){return 1}},{name:"Entropic Redistribution",career:"Temporal",baseDamage:1500,damageType:"Physical",rankModifiers:[0,.3,.6],epgCategory:"cat1",icon:"Entropic_Redistribution_icon"},{name:"Rapid Decay",career:"Temporal",baseDamage:400,damageType:"Physical",rankModifiers:[0,.3,.6],epgCategory:"cat1",icon:"Rapid_Decay_icon",isDoT:!0},{name:"Timeline Collapse",career:"Temporal",baseDamage:1e3,damageType:"Physical",rankModifiers:[7/15,9.1/15,11.2/15],rankCategory:"aux",epgCategory:"cat1",icon:"Timeline_Collapse_icon"}],categories:[{id:"base",name:"Base Damage"},{id:"rank",name:"Ability Rank",initialValue:1},{id:"aux",name:"Auxiliary Power"},{id:"epg",name:"EPG",initialValue:1},{id:"cat1",name:'"Category 1"',initialValue:1},{id:"cat2",name:'"Category 2"',initialValue:1}],modifiers:[{id:"base",name:"Base Damage",category:"base",value:function(a){return a.ability.baseDamage},damageType:function(a){return a.ability.damageType},damagePrecision:function(a){return a.ability.damagePrecision},hidden:!0,template:"card-damage",info:"This is the damage applied with no other modifiers."},{id:"rank1",name:"Rank 1",suffix:"I",category:function(a){return a.ability.rankCategory||"rank"},value:function(a){return a.ability.rankModifiers[0]},hidden:!0,template:"card-damage-modifier",info:"Each rank above Rank 1 adds a percentage of damage. The amount can vary between abilities."},{id:"rank2",name:"Rank 2",suffix:"II",category:function(a){return a.ability.rankCategory||"rank"},value:function(a){return a.ability.rankModifiers[1]},hidden:!0,template:"card-damage-modifier",info:"Each rank above Rank 1 adds a percentage of damage. The amount can vary between abilities."},{id:"rank3",name:"Rank 3",suffix:"III",category:function(a){return a.ability.rankCategory||"rank"},value:function(a){return a.ability.rankModifiers[2]},hidden:!0,template:"card-damage-modifier",info:"Each rank above Rank 1 adds a percentage of damage. The amount can vary between abilities."},{id:"level",name:"Character Level Scaling",category:"cat1",value:function(b){return(b.ability.levelScaling||a)(b.level)},hidden:!0,template:"card-damage-modifier",info:"Exotic abilities gain damage with each level your character gains."},{id:"aux",name:"Auxiliary Power",category:"aux",value:function(a){return(a.ability.auxScaling||b)(a.aux)},hidden:!0,template:"card-damage-multiplier",info:"Most Exotic abilities gain damage when your Auxiliary Power Level is above 100, but lose damage when it is below."},{id:"epg",name:"Exotic Particle Generator",type:"Space Science Skill",category:function(a){return a.ability.epgCategory||"epg"},value:function(a){return a.epg/200},hidden:!0,template:"card-damage-modifier",info:"Your EPG skill value increases the damage of Exotic abilities. Some abilities apply this bonus in a different group."},{name:"Causal Anchor",type:"Console",value:.15,category:"cat1",icon:"Console_-_Universal_-_Causal_Anchor_icon",rarity:"Epic",template:"card-damage-modifier",damageType:"Exotic",unique:!0},{name:"Constriction Anchor",type:"Console",value:.236785,category:"cat2",icon:"Console_-_Universal_-_Constriction_Anchor_icon",rarity:"Epic",template:"card-damage-modifier",damageType:"Exotic",unique:!0},{name:"Auxiliary Ejection Assembly",type:"Console",value:.178,category:"cat2",icon:"Console_-_Universal_-_Auxiliary_Ejection_Assembly_icon",rarity:"Epic",template:"card-damage-modifier",damageType:"Exotic",unique:!0,info:"Untested. May be in another Category. May have an inaccurate value."},{name:"Temporal Distortion Field",type:"Console",value:.075,category:"cat1",icon:"Console_-_Universal_-_Temporal_Distortion_Field_icon",rarity:"Epic",template:"card-damage-modifier",damageType:"Exotic",unique:!0},{name:"Pirate",type:"Bridge Officer Trait",value:function(a,b){return.015*b.stacks},category:"cat2",icon:"Pirate_icon",template:"card-stackable-damage-mod",stacks:"1",maxStacks:5,stackName:"Pirate Bridge Officer(s)",damageType:"All",unique:!0},{name:"Enhanced Particle Generators",type:"Starship Mastery - Science Vessel",value:.15,category:"cat1",icon:"Mastery_passive_enhanced_particle_generators_sci_fed",template:"card-damage-modifier",damageType:"Exotic",unique:!0},{id:"missile-commander",name:"Missile Commander",type:"Accolade Passive",value:function(a){return"Kinetic"==a.ability.damageType?.02:0},category:"cat1",template:"card-damage-modifier",damageType:function(a){return"Kinetic"==a.ability.damageType?"Kinetic":""},info:"Most characters will have this passive bonus to Kinetic damage unlocked.",unique:!0},{name:"Fleet Combat Performance Boost",type:"Research Lab Project",value:.2,category:"cat1",damageType:"All",icon:"Ship_icon",template:"card-damage-modifier",unique:!0},{name:"Fleet Coordinator",type:"Personal Space Trait",value:function(a,b){return.02*b.stacks},category:"cat2",damageType:"All",icon:"Fleet_Coordinator_icon",template:"card-stackable-damage-mod",stacks:"1",maxStacks:5,stackName:"Player(s) in Team (Including Self)",unique:!0},{name:"Anchored",type:"Personal Space Trait",value:function(a,b){return.05*b.stacks},category:"cat2",damageType:"All",icon:"Anchored_icon",template:"card-stackable-damage-mod",stacks:"1",maxStacks:4,unique:!0},{name:"Auxiliary Power Configuration - Offense",type:"Space Reputation Trait",value:function(a){return.05*a.aux/100},category:"cat2",damageType:"All",icon:"Auxiliary_Power_Configuration_-_Offense_icon",template:"card-damage-modifier",unique:!0},{name:"Particle Generator Amplifier",type:"Space Reputation Trait",value:.05,category:"cat2",damageType:"Exotic",icon:"Particle_Generator_Amplifier_icon",template:"card-damage-modifier",unique:!0},{name:"Synergy Amp",type:"[AMP] Warp Core Mod",value:function(a,b){return.033*b.stacks},category:"cat1",damageType:"All",template:"card-stackable-damage-mod",stacks:"1",maxStacks:4,stackName:"Subsystem(s) at 75+ Power",icon:"Field_Stabilizing_Warp_Core_icon",rarity:"Ultra_Rare",unique:!0},{name:"Offensive Coordination",type:"Skill",value:function(a,b){return.05*b.stacks},category:"cat1",damageType:"All",template:"card-stackable-damage-mod",stacks:"1",maxStacks:4,stackName:"Teammate(s) with this Skill",icon:"Tactical_Skill_1_R1",unique:!0},{name:"Improved Feedback Pulse",type:"Starship Trait",value:function(a){return"Feedback Pulse"==a.ability.name?.5:0},category:"cat1",template:"card-damage-modifier",icon:"Mastery_trait_improved_feedback_pulse",unique:!0,info:"This bonus is listed separately on the in-game tooltip, so is for info only."},{name:"Pedal to the Metal",type:"Starship Trait",value:function(a,b){return.01*b.stacks},category:"cat2",template:"card-stackable-damage-mod",stacks:"1",maxStacks:10,icon:"Pedal_to_the_Metal_icon",unique:!0},{name:"Improved Pedal to the Metal",type:"Starship Trait",value:function(a,b){return.02*b.stacks},category:"cat2",template:"card-stackable-damage-mod",stacks:"1",maxStacks:10,icon:"Pedal_to_the_Metal_icon",unique:!0},{name:"Numerical Superiority",type:"Starship Trait",value:function(a,b){return.1*b.stacks},category:"cat1",damageType:"All",template:"card-stackable-damage-mod",stacks:"1",maxStacks:5,stackName:"All(y|ies) on target (Including Self)",icon:"Mastery_trait_numerical_superiority",unique:!0},{name:"Support Configuration",type:"Molecular Reconstruction Ability",value:.2,category:"cat1",damageType:"Exotic",template:"card-damage-modifier",icon:"Support_Configuration_icon",unique:!0},{name:"Entropic Amplification",type:"Temporal Operative Specialization",value:function(a,b){return a.ability.isDoT?.1*b.stacks:0},category:"cat1",damageType:"DoT",template:"card-stackable-damage-mod",stacks:"1",maxStacks:2,stackName:"Rank(s)",icon:"Temporal_Operative_t1_Entropic_Amplification_icon",unique:!0},{name:"Predictive Decay Algorithms",type:"Temporal Rep Starship Set (2pc)",value:function(a,b){return a.ability.isDoT||a.ability.isHazard?.25:0},category:"cat1",damageType:"DoT/Hazard",template:"card-damage-modifier",icon:"Temporal_Defense_Initiative_Combat_Impulse_Engines_icon",rarity:"Ultra_Rare",unique:!0},{name:"Z Custom",type:"Custom Bonus for Testing",value:1,category:"cat1",damageType:"All",template:"card-custom",icon:"Ship_icon",save:function(a){return[a.value,a.category]},load:function(a,b){a.value=Number(b[0])||1,a.category=b[1]||"cat1"}}]},f=function(a,b){var c=a.name.split(/\W+/),d="";return c.forEach(function(a,e){d+=a.substring(0,1+Math.floor(b/c.length)+(e<b%c.length?1:0))}),d},g=function(a){var b=[];a.forEach(function(a){var c="x",d=0;do c=f(a,d++);while(b.indexOf(c)>=0);b.push(c),a.abbr=c})};return g(e.abilities),g(e.modifiers),e.modifiers.forEach(function(a){a.stacks&&!a.save&&(a.save=function(a){return[a.stacks]},a.load=function(a,b){return a.stacks=isNaN(b[0])?"1":b[0]})}),e});var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_module=angular.module("sto-exotics",["ngSanitize","sto-exotics-data","sto-exotics-card"]);_module.filter("valueOf",["$rootScope",function(a){return function(a,b,c){return"function"==typeof a?a(b,c):a}}]),_module.filter("round",function(){return function(a,b){return Number(a).toFixed(b||1).replace(/\.0+$/,"")}}),_module.filter("abs",function(){return function(a){return Math.abs(a)}}),_module.filter("unique",function(){return function(a,b){return a.filter(function(a){return!a.unique||b.modifiers.indexOf(a)<0})}}),_module.filter("plural",function(){return function(a,b){return a.replace(/\(s\)/,1!=b?"s":"").replace(/\((.+)\|(\w+)\)/,1!=b?"$2":"$1")}}),_module.filter("catName",function(){return function(a,b){return b.data.categories.filter(function(b){return b.id==a}).shift().name.replace(/"/g,"")}}),_module.controller("StoExoticsCtrl",["$scope","$location","exoticsData",function(a,b,c){var d=a.modifier=function(a){var b=c.modifiers.filter(function(b){return b.id==a&&b});return b.length>0&&b[0]};a.current={ability:c.abilities[0],level:60,aux:100,epg:0,modifiers:[d("base"),d("rank1"),d("level"),d("aux"),d("epg"),d("missile-commander")],data:c};a.data=c;var e=function(b,c){return"function"==typeof b?b(a.current,c):b};a.isCat=function(a){return function(b){return e(b.category,b)==a}};var f=a.noCat=function(a){return!e(a.category,a)},g=a.addModifier=function(a,b){a.unique&&b.modifiers.indexOf(a)>=0||(a.unique||(a=angular.copy(a)),b.modifiers.push(a))};a.removeMod=function(b){return a.current.modifiers=a.current.modifiers.filter(function(a){return b!=a})};var h=a.categorySum=function(a,b){var c=b.modifiers.filter(function(b){return e(b.category,b)==a.id&&b}),d=a.initialValue||0;return c.forEach(function(a){return d+=e(a.value,a)}),d};a.calculateDamage=function(a){var b=c.categories.map(function(b){return h(b,a)});a.modifiers.filter(function(a){return f(a)}).forEach(function(a){return b.push(e(a.value,a))});var d=1;return b.forEach(function(a){return d*=a}),d};var i=function(a){return a.filter(function(a){return!a.hidden}).map(function(a){return a.abbr+(a.save?":"+a.save(a).join(":"):"")})},j=function(a){return[a.ability.abbr,a.modifiers[1].abbr,a.level,a.aux,a.epg].concat(_toConsumableArray(i(a.modifiers)))},k=function(a,b){var c=a.split(":"),d=_toArray(c),a=d[0],e=d.slice(1),f=b.data.modifiers.filter(function(b){return b.abbr==a}),h=_slicedToArray(f,1),i=h[0];return i?(i.load&&i.load(i,e),void g(i,b)):void console.log("Failed to load:",a,e)},l=function(a,b){var d=_toArray(a),e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d.slice(5),l=c.abilities.filter(function(a){return a.abbr==e}),m=_slicedToArray(l,1),e=m[0];e&&(b.ability=e);var n=c.modifiers.filter(function(a){return a.abbr==f}),o=_slicedToArray(n,1),f=o[0];f&&(b.modifiers[1]=f),b.level=Number(g),b.aux=Number(h),b.epg=Number(i),b.modifiers=b.modifiers.filter(function(a){return a.hidden}),j.forEach(function(a){return k(a,b)})};a.$watch("current",function(a){b.path("/build/"+j(a).join(","))},!0);var m=b.path().split("/"),n=_toArray(m),o=n[1],p=n.slice(2);"build"==o&&l(p.length>0?p[0].split(","):[],a.current)}]),angular.module("sto-exotics").run(["$templateCache",function(a){a.put("card-custom.html",'<div ng-include="\'card-damage-modifier.html\'"></div>\r\n<select class="form-control" ng-model="item.category" style="clear: both; margin-top: 11px;" ng-options="cat.id as cat.name for cat in current.data.categories">\r\n<input class="form-control" ng-if="isNumber(item.value)" ng-model="item.value" type="number" step="0.01">'),a.put("card-damage-modifier.html",'<span ng-if="(item.value|valueOf:current:item) != 0">+{{((item.value|valueOf:current:item)*100)|round}}%<span ng-if="item.damageType"> {{item.damageType|valueOf:current}}</span> Damage</span>\r\n<span ng-if="(item.value|valueOf:current:item) == 0">No Effect</span>'),a.put("card-damage-multiplier.html",'<div ng-class="{\'highlight-bad\': (item.value|valueOf:current:item) < 1 }">\r\n<span ng-if="(item.value|valueOf:current:item)>=1">+</span><span ng-if="(item.value|valueOf:current:item)<1">-</span>{{((1-(item.value|valueOf:current:item))*100)|abs|round}}% <span ng-if="item.damageType">{{item.damageType|valueOf:current}}</span> Damage\r\n</div>'),a.put("card-damage.html","{{item.value|valueOf:current:item|round:(item.damagePrecision|valueOf:current)}} {{item.damageType|valueOf:current}} Damage"),a.put("card-stackable-damage-mod.html",'<div ng-include="\'card-damage-modifier.html\'"></div>\r\n<select class="form-control" ng-model="item.stacks" style="clear: both; margin-top: 11px;">\r\n\t<option ng-repeat="val in range(1,item.maxStacks)" value="{{val}}">{{val}} {{(item.stackName||"Stack(s)")|plural:val}}</option>\r\n</select>'),a.put("card.html",'<div class="card">\r\n\t<div style="display: inline-block; position: relative; float: left;">\r\n\t\t<img ng-if="item.icon" ng-src="img/{{item.icon}}.png" class="pull-left card-image">\r\n\t\t<div ng-if="item.rarity" style="display: inline-block; position: absolute; left: 0;">\r\n\t\t\t<img class="card-rarity" ng-src="img/{{item.rarity}}_icon.png">\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="pull-right card-toolbar">\r\n\t\t<button class="btn-add" ng-if="add" ng-click="add(item,current)"><span ng-if="showCategory" class="card-category card-category-{{item.category}}">{{item.category|catName:current}}</span> <i class="fa fa-plus"></i></button>\r\n\t\t<button class="btn-remove" ng-if="remove" ng-click="remove(item)"><i class="fa fa-trash"></i></button>\r\n\t</div>\r\n\t<p class="card-title">{{item.name}}<span ng-if="item == current.ability"> {{current.modifiers[1].suffix}}</span></p>\r\n\t<p class="card-subtitle">{{item.type}}</p>\r\n\t<p ng-if="item.template" ng-include="item.template+\'.html\'"></p>\r\n\t<p ng-if="item.text" ng-bind="item.text"></p>\r\n\t<p class="card-info" ng-if="item.info" ng-bind="item.info"></p>\r\n\t<p ng-transclude></p>\r\n\t<div style="clear: both"></div>\r\n</div>')}]);
//# sourceMappingURL=sto-exotics.min.js.map