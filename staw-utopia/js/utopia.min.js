var module=angular.module("utopia-card-faction",[]);module.directive("cardFaction",function(){return{scope:{faction:"=",dragStore:"=",dragSource:"="},templateUrl:"card-faction.html",controller:["$scope",function(a){}]}});var module=angular.module("utopia-card-loader",["utopia-card-rules","utopia-card-ship","utopia-card-upgrade","utopia-card-resource","utopia-card-faction"]);module.factory("cardLoader",["$http","$filter","cardRules","$factions",function(a,b,c,d){var e=b("valueOf");return function(f,g,h,i){function j(a,b){var c=!1;return $.each(b,function(b,d){return a.id==d.id&&a.type==d.type?(c=!0,!1):void 0}),c}function k(a){if(j(a,f))return void console.log("Duplicate card definition ignored",a.id);a.mirror=d.hasFaction(a,"mirror-universe");for(var b=0;b<a.upgrades.length;b++)"string"==typeof a.upgrades[b]&&(a.upgrades[b]={type:[a.upgrades[b]],source:"ship"});$.extend(!0,a,s),a.squadron&&(a.canJoinFleet=function(a,b,c){var d=0,e=0;return $.each(c.ships,function(a,b){b.squadron?e++:b.hull>=4&&d++}),d>e}),c[a.type+":"+a.id]&&$.extend(!0,a,c[a.type+":"+a.id]);var g=a.intercept.ship.cost;a.intercept.ship.cost=function(a,b,c,f){if(g&&(f=g(a,b,c,f)),!d.match(a,b,b,c)){var h=e(a,"factionPenalty",b,c);return(f instanceof Function?f(a,b,c,0):f)+h}return f},f.push(a)}function l(a){if(j(a,f))return void console.log("Duplicate card definition ignored",a.id);$.extend(!0,a,t),a.mirror=d.hasFaction(a,"mirror-universe"),a.upgradeSlots=[];for(var b=0;b<a.talents;b++)a.upgradeSlots.push({type:["talent"],source:a.name});c[a.type+":"+a.id]&&$.extend(!0,a,c[a.type+":"+a.id]),f.push(a)}function m(a){if(j(a,f))return void console.log("Duplicate card definition ignored",a.id);$.extend(!0,a,u),a.mirror=d.hasFaction(a,"mirror-universe"),a.upgradeSlots=[];for(var b=0;b<a.talents;b++)a.upgradeSlots.push({type:["talent"],source:a.name});a.intercept.ship.skill=function(b,c,d,e){return b==c.captain&&(e=(e instanceof Function?e(b,c,d,0):e)+a.skill),e},c[a.type+":"+a.id]&&$.extend(!0,a,c[a.type+":"+a.id]),f.push(a)}function n(a){return j(a,f)?void console.log("Duplicate card definition ignored",a.id):($.extend(!0,a,v),a.mirror=d.hasFaction(a,"mirror-universe"),c[a.type+":"+a.id]&&$.extend(!0,a,c[a.type+":"+a.id]),void f.push(a))}function o(a){$.extend(!0,a,w),c[a.type+":"+a.id]&&$.extend(!0,a,c[a.type+":"+a.id]),f.push(a)}function p(a){if("fleet-captain"==a.type){for(var d=0;d<a.talentAdd;d++)a.upgradeSlots.push({type:["talent"],source:"Fleet Captain (Free talent if another talent slot is empty)",showOnCard:!0,intercept:{ship:{cost:function(a,c,d,e){var f=b("upgradeSlots")(c),g=!1;return $.each(f,function(a,b){b.type.indexOf("talent")>=0&&!b.occupant&&(g=!0)}),g?0:e}}}});for(var d=0;d<a.techAdd;d++)a.upgradeSlots.push({type:["tech"],source:"Fleet Captain",showOnCard:!0});for(var d=0;d<a.weaponAdd;d++)a.upgradeSlots.push({type:["weapon"],source:"Fleet Captain",showOnCard:!0});for(var d=0;d<a.crewAdd;d++)a.upgradeSlots.push({type:["crew"],source:"Fleet Captain",showOnCard:!0});a.intercept.ship.skill=function(b,c,d,e){return b==c.captain&&(e=(e instanceof Function?e(b,c,d,0):e)+a.skill),e}}if("flagship"==a.type){var e=a;e.intercept.ship={attack:function(a,b,c,d){return a==b&&"flagship"!=b.type?(d instanceof Function?d(a,b,c,0):d)+e.attack:d},agility:function(a,b,c,d){return a==b&&"flagship"!=b.type?(d instanceof Function?d(a,b,c,0):d)+e.agility:d},hull:function(a,b,c,d){return a==b&&"flagship"!=b.type?(d instanceof Function?d(a,b,c,0):d)+e.hull:d},shields:function(a,b,c,d){return a==b&&"flagship"!=b.type?(d instanceof Function?d(a,b,c,0):d)+e.shields:d}}}c[a.type+":"+a.id]&&$.extend(!0,a,c[a.type+":"+a.id]),f.push(a)}function q(a){return g[a.id]?void console.log("Duplicate set",a.id,a.name):void(g[a.id]=a)}function r(a){return h[a.id]?void console.log("Duplicate ship class",a.id,a.name,h[a.id].name):void(h[a.id]=a)}var s={canJoinFleet:!0,intercept:{ship:{},fleet:{}}},t={factionPenalty:1,intercept:{ship:{},fleet:{}},canEquip:!0,canEquipCaptain:!0,canEquipFaction:!0,showType:!0},u={factionPenalty:3,intercept:{ship:{},fleet:{}},canEquip:!0,canEquipAdmiral:!0,canEquipFaction:!0,isSkillModifier:!0,showType:!0},v={factionPenalty:1,intercept:{ship:{},fleet:{}},canEquip:!0,canEquipFaction:!0},w={intercept:{ship:{},fleet:{}},canEquip:!0,canEquipFaction:!0};a.get("data/data.json").success(function(a){$.each(a.sets||[],function(a,b){q(b)}),$.each(a.ships||[],function(a,b){k(b)}),$.each(a.shipClasses||[],function(a,b){r(b)}),$.each(a.captains||[],function(a,b){l(b)}),$.each(a.admirals||[],function(a,b){m(b)}),$.each(a.upgrades||[],function(a,b){n(b)}),$.each(a.resources||[],function(a,b){o(b)}),$.each(a.others||[],function(a,b){p(b)}),$.each(f,function(a,b){"ship"==b.type&&(b.classId||$.each(h,function(a,c){return c.name==b["class"]?(b.classId=a,!1):void 0}),b.classId&&h[b.classId]||console.log("No class for ship",b.id,b.name,b.classId))}),i&&i()})}}]);var module=angular.module("utopia-card-resource",[]);module.directive("cardResource",function(){return{scope:{resource:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-resource.html",controller:["$scope",function(a){}]}});var module=angular.module("utopia-card-rules",[]);module.factory("$factions",["$filter",function(a){var b=a("valueOf");return{hasFaction:function(a,c,d,e){return a?$.inArray(c,b(a,"factions",d,e))>=0:!1},match:function(a,c,d,e){var f=!1;return $.each(b(a,"factions",d,e),function(a,g){return $.each(b(c,"factions",d,e),function(a,b){return g==b?(f=!0,!1):void 0}),f?!1:void 0}),f},list:["Federation","Klingon","Romulan","Dominion","Borg","Species 8472","Kazon","Bajoran","Ferengi","Vulcan","Independent","Mirror Universe"]}}]),module.factory("cardRules",["$filter","$factions",function(a,b){var c=a("valueOf"),d=function(b){return function(c,d,e){var f=!1,g=a("upgradeSlots")(d);return $.each(g,function(a,d){d.occupant&&d.occupant!=c&&d.occupant.name==b&&(f=!0)}),!f}};return{"ship:tactical_cube_138_71444":{intercept:{ship:{cost:function(a,b,c,d){return"Borg Ablative Hull Armor"==a.name?(d instanceof Function?d(a,b,c,d):d)-3:d}}}},"ship:enterprise_nx_01_71526":{upgradeSlots:[{type:["tech"],source:"Enterprise NX-01 (Free EHP Only)",canEquip:function(a){return"Enhanced Hull Plating"==a.name},intercept:{ship:{cost:function(){return 0}}}}]},"ship:scout_608_71525":{intercept:{ship:{canEquip:function(a,b,c){return"borg"==a.type?a.cost<=5:!0}}}},"ship:borg_starship_71525":{intercept:{ship:{canEquip:function(a,b,c){return"borg"==a.type?a.cost<=5:!0}}}},"ship:scout_255_71646d":{intercept:{ship:{canEquip:function(a,b,c){return"borg"==a.type?a.cost<=5:!0}}}},"ship:korok_s_bird_of_prey_71512":{canJoinFleet:function(a,b,c){var d=!0;return $.each(c.ships,function(a,b){return"Assimilated Vessel 80279"==b.name?(d=!1,!1):void 0}),d},intercept:{fleet:{canJoinFleet:function(a,b,c){return"Assimilated Vessel 80279"!=a.name}}}},"ship:trager_71513b":{canJoinFleet:function(a,b,c){var d=!0;return $.each(c.ships,function(a,b){return"Assimilated Vessel 64758"==b.name?(d=!1,!1):void 0}),d},intercept:{fleet:{canJoinFleet:function(a,b,c){return"Assimilated Vessel 64758"!=a.name}}}},"ship:regent_s_flagship_71535":{"class":"Negh'var Class"},"ship:prototype_01_71536":{intercept:{ship:{canEquipCaptain:function(a,b,c){return"Gareb"==a.name||"Romulan Drone Pilot"==a.name}}}},"ship:romulan_starship_71536":{intercept:{ship:{canEquipCaptain:function(a,b,c){return"Gareb"==a.name||"Romulan Drone Pilot"==a.name}}}},"ship:sakharov_71997p":{upgradeSlots:[{type:["crew","tech"],source:"Sakharov (-2 SP)",intercept:{ship:{cost:function(a,b,c,d){return d=(d instanceof Function?d(a,b,c,d):d)-2,0>d&&(d=0),d}}}}]},"ship:u_s_s_enterprise_d_71510b":{"class":"Galaxy Class",classId:"galaxy__class_mu"},"ship:mirror_universe_starship_71510b":{"class":"Galaxy Class",classId:"galaxy__class_mu"},"ship:assimilation_target_prime_71510b":{"class":"Galaxy Class",classId:"galaxy__class_mu"},"ship:mirror_universe_borg_starship_71510b":{"class":"Galaxy Class",classId:"galaxy__class_mu"},"captain:2008":{intercept:{ship:{factionPenalty:function(a,b,c,d){return"captain"!=a.type&&"admiral"!=a.type?0:d}}}},"captain:2009":{intercept:{ship:{factionPenalty:function(a,b,c,d){return"captain"==a.type||"talent"==a.type?0:d}}}},"captain:2011":{upgradeSlots:[{type:["talent"],source:"James T. Kirk (=3 SP)",intercept:{ship:{cost:function(a,b,c,d){return 3},factionPenalty:function(){return 0}}}},{type:["talent"],source:"James T. Kirk (=3 SP)",intercept:{ship:{cost:function(a,b,c,d){return 3},factionPenalty:function(){return 0}}}}]},"captain:2012":{intercept:{ship:{cost:function(a,b,c,d){return"crew"==a.type&&(d=(d instanceof Function?d(a,b,c,d):d)-1,0>d&&(d=0)),d}}}},"captain:2023":{intercept:{ship:{cost:function(a,b,c,d){return"weapon"==a.type&&(d=(d instanceof Function?d(a,b,c,d):d)-1,0>d&&(d=0)),d}}}},"captain:2030":{factionPenalty:function(a,c,d){return b.hasFaction(c,"federation",c,d)?0:1}},"captain:2035":{cost:function(d,e,f){if(!e)return 2;var g=!1,h=0;return $.each(a("upgradeSlots")(e),function(a,i){if(i.occupant&&i.occupant!=d&&"admiral"!=i.occupant.type&&b.hasFaction(i.occupant,"dominion",e,f)){var j=c(i.occupant,"cost",e,f);j>h&&(g=i.occupant,h=c(i.occupant,"cost",e,f))}}),h>2?0:2-h}},"captain:3106":{upgradeSlots:[{type:["tech"],source:"Styles"}]},"captain:weyoun_71279":{upgradeSlots:[{},{type:["crew"],source:"Weyoun (-1 SP Dominion)",intercept:{ship:{cost:function(a,c,d,e){return b.hasFaction(a,"dominion",c,d)&&(e=(e instanceof Function?e(a,c,d,0):e)-1),e}}}},{type:["crew"],source:"Weyoun (-1 SP Dominion)",intercept:{ship:{cost:function(a,c,d,e){return b.hasFaction(a,"dominion",c,d)&&(e=(e instanceof Function?e(a,c,d,0):e)-1),e}}}}]},"captain:tahna_los_op6prize":{upgradeSlots:[{},{type:["tech"],source:"Tahna Los (=3 SP)",intercept:{ship:{cost:function(a,b,c,d){return 3},factionPenalty:function(){return 0}}}}]},"captain:tavek_71446":{upgradeSlots:[{type:["crew"],source:"Tavek"}]},"captain:hugh_71522":{intercept:{ship:{cost:function(a,b,c,d){return"crew"==a.type?(d instanceof Function?d(a,b,c,0):d)-1:d},factionPenalty:function(a,c,d,e){return"captain"!=a.type&&"admiral"!=a.type&&b.hasFaction(a,"borg",c,d)?0:e}}}},"captain:lore_71522":{upgradeSlots:[{source:"Lore (No Faction Restriction or Penalty)",intercept:{ship:{canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}},{type:["crew"],source:"Lore"}]},"captain:vanik_71508":{intercept:{ship:{cost:function(a,c,d,e){return"tech"==a.type&&(b.hasFaction(a,"vulcan",c,d)||b.hasFaction(a,"federation",c,d))&&(e=(e instanceof Function?e(a,c,d,0):e)-2,0>e&&(e=0)),e}}}},"captain:magnus_hansen_71509":{factionPenalty:function(a,c,d){return b.hasFaction(c,"federation",c,d)?0:1}},"captain:jonathan_archer_71526":{upgradeSlots:[{},{type:["crew"],source:"Jonathan Archer"}]},"captain:sopek_71527":{upgradeSlots:[{},{type:["crew"],source:"Sopek"}]},"captain:third_of_five_71525":{canEquip:function(b,c,d){return!a("fleetCardNamed")(d,"Hugh")},intercept:{fleet:{canEquip:function(a,b,c,d){return"Hugh"==a.name?!1:d},canEquipCaptain:function(a,b,c,d){return"Hugh"==a.name?!1:d}}}},"captain:jean_luc_picard_71510":{upgradeSlots:[{},{type:["crew"],source:"Jean-Luc Picard"}]},"captain:haron_71646c":{upgradeSlots:[{type:["weapon"],source:"Haron"}],intercept:{ship:{cost:function(a,c,d,e){return"weapon"==a.type&&b.hasFaction(a,"kazon",c,d)&&(e=(e instanceof Function?e(a,c,d,0):e)-1,0>e&&(e=0)),e}}}},"captain:jean_luc_picard_b_71531":{upgradeSlots:[{},{type:["crew","tech","weapon","talent"],source:"Jean-Luc Picard"}]},"captain:chakotay_71528":{upgradeSlots:[{},{type:["weapon","crew"],source:"Chakotay"}]},"captain:calvin_hudson_71528":{upgradeSlots:[{type:["tech","weapon","crew"],source:"Calvin Hudson"}],intercept:{ship:{cost:function(a,c,d,e){return b.hasFaction(c,"independent",c,d)&&$.inArray(a.type,["talent","crew","tech","weapon"])>=0&&(e=(e instanceof Function?e(a,c,d,0):e)-1),e}}}},"captain:miles_o_brien_71529":{upgradeSlots:[{},{type:["tech"],source:"Miles O'Brien"}]},"captain:borg_queen_71513a":{upgradeSlots:[{},{type:["borg"],source:"Borg Queen"}]},"captain:locutus_71792":{canEquipCaptain:function(b,c,d){return!a("fleetCardNamed")(d,"Jean-Luc Picard")},intercept:{fleet:{canEquip:function(a,b,c,d){return"Jean-Luc Picard"==a.name?!1:d},canEquipCaptain:function(a,b,c,d){return"Jean-Luc Picard"==a.name?!1:d}}}},"captain:gareb_71536":{upgradeSlots:[{type:["captain"],source:"Gareb",intercept:{ship:{cost:function(){return 0},onEquip:function(a,b,c){a.upgradeSlots=[];for(var d=0;d<a.talents;d++)a.upgradeSlots.push({type:["talent"],source:"Gareb"});a.unique=!1,a.text="(Place underneath Gareb)",a.name=a.name+" (Gareb)"},canEquip:function(){return!0},canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}}],skill:function(a,b,c){return a.upgradeSlots[0].occupant?a.upgradeSlots[0].occupant.skill:0},cost:function(a,b,c){var d=0;return a.upgradeSlots[0].occupant&&(d=a.upgradeSlots[0].occupant.cost-3,0>d&&(d=0)),d},canEquipCaptain:function(a,b,c){return"Romulan Drone Ship"==b["class"]}},"captain:romulan_drone_pilot_71536":{canEquipCaptain:function(a,b,c){return"Romulan Drone Ship"==b["class"]}},"captain:valdore_71536":{upgradeSlots:[{},{type:["tech"],source:"Valdore"}]},"captain:slar_71797":{upgradeSlots:[{type:["talent"],source:"Slar (Salvage Only)",canEquip:function(a){return"Salvage"==a.name}}]},"weapon:3010":{attack:function(a,b,c){return b&&"Vor'cha Class"==b["class"]?6:5}},"crew:3039":{cost:function(a,b,c){return b&&"Romulan Science Vessel"!=b["class"]?10:5}},"tech:3041":{canEquip:function(a,b,c){return"Romulan Science Vessel"==b["class"]}},"weapon:3051":{attack:function(a,b,c){return b&&"Negh'var Class"==b["class"]?6:5}},"weapon:3059":{cost:function(a,b,c){return b&&b["class"].indexOf("Breen")<0?10:5}},"tech:3068":{cost:function(a,b,c){return b&&"U.S.S. Defiant"!=b.name?9:4}},"tech:3080":{canEquip:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")>=0}},"weapon:3081":{cost:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")<0?10:5}},"crew:3082":{canEquip:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")>=0}},"crew:3083":{canEquip:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")>=0}},"crew:3084":{canEquip:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")>=0}},"weapon:3096":{attack:function(a,b,c){return b&&"Keldon Class"==b["class"]?6:5}},"tech:3099":{cost:function(a,b,c){return b&&"Keldon Class"!=b["class"]?9:4}},"tech:cold_storage_unit_op5prize":{upgradeSlots:[{type:["weapon"],source:"Cold Storage Unit"},{type:["weapon"],source:"Cold Storage Unit"}]},"talent:klingon_honor_71448":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"klingon",c,d)}},"tech:shockwave_71448":{canEquip:function(a,b,c){return"Raptor Class"==b["class"]}},"tech:tactical_sensors_71448":{canEquip:function(a,b,c){return"Raptor Class"==b["class"]}},"crew:kudak_etan_71279":{canEquip:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")>=0}},"crew:ikat_ika_71279":{cost:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")<0?10:5}},"weapon:photon_torpedoes_71279":{attack:function(a,b,c){return b&&"Jem'Hadar Battleship"==b["class"]?7:5}},"weapon:phased_polaron_beam_71279":{cost:function(a,b,c){return b&&b["class"].indexOf("Jem'Hadar")<0?10:5}},"talent:i_am_kohn_ma_op6prize":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"bajoran",c,d)}},"tech:ablative_generator_71280":{canEquip:function(a,b,c){return"U.S.S. Voyager"==b.name}},"crew:b_elanna_torres_71280":{name:"B'Elanna Torres",upgradeSlots:[{type:["weapon"],source:"B'Elanna Torres"},{type:["tech"],source:"B'Elanna Torres"}]},"tech:bio_electric_interference_71281":{canEquip:function(a,c,d){return b.hasFaction(c,"species-8472",c,d)}},"tech:extraordinary_immune_response_71281":{canEquip:function(a,c,d){return b.hasFaction(c,"species-8472",c,d)}},"crew:kazon_raiding_party_71282":{canEquip:function(a,c,d){return b.hasFaction(c,"kazon",c,d)}},"tech:masking_circuitry_71282":{cost:function(a,c,d){return c&&b.hasFaction(c,"kazon",c,d)?8:3}},"tech:quantum_singularity_71281":{canEquip:function(a,c,d){return b.hasFaction(c,"species-8472",c,d)}},"talent:the_weak_will_perish_71281":{cost:function(a,c,d){return c&&b.hasFaction(c,"species-8472",c,d)?10:5}},"weapon:biological_attack_71281":{canEquip:function(a,c,d){return b.hasFaction(c,"species-8472",c,d)}},"tech:cutting_beam_71283":{canEquip:function(a,c,d){return b.hasFaction(c,"borg",c,d)}},"weapon:energy_blast_71281":{attack:function(a,b,c){return b&&"Species 8472 Bioship"==b["class"]?7:5}},"weapon:energy_focusing_ship_71281":{canEquip:function(a,c,d){return b.hasFaction(c,"species-8472",c,d)}},"weapon:transphasic_torpedoes_71280":{canEquip:function(a,b,c){return"U.S.S. Voyager"==b.name}},"talent:tholian_punctuality_opwebprize":{canEquipFaction:function(a,b,c){return b.captain&&("Loskene"==b.captain.name||b.captain.name.indexOf("Tholian")>=0)}},"weapon:energy_web_opwebprize":{canEquip:function(a,b,c){return"Tholian Vessel"==b["class"]}},"talent:vulcan_high_command_2_0_71446":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c,"vulcan",c,d)&&b.hasFaction(c.captain,"vulcan",c,d)},upgradeSlots:[{type:["tech","crew"],source:"Vulcan High Command"},{type:["tech","crew"],source:"Vulcan High Command"}]},"tech:warp_drive_refit_71445":{canEquip:function(a,b,c){return!0}},"tech:maneuverability_71445":{cost:function(a,b,c){return b&&"Bajoran Interceptor"!=b["class"]?10:5}},"talent:assimilated_access_codes_71444":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"borg",c,d)}},"weapon:phaser_strike_71445":{cost:function(a,b,c){return b&&"Bajoran Interceptor"!=b["class"]?9:4},canEquip:function(a,b,c){return b.hull<=3}},"weapon:full_assault_71444":{attack:function(a,b,c){return b&&"Borg Tactical Cube"==b["class"]?9:6}},"weapon:borg_missile_71444":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"borg",c,d)}},"crew:sakonna_gavroche":{upgradeSlots:[{type:["weapon"],source:"Sakonna"}],intercept:{ship:{cost:function(a,b,c,d){return"weapon"==a.type&&(d=d instanceof Function?d(a,b,c,0):d,5>=d&&(d-=2)),d}}}},"talent:first_strike_3rd_wing_attack_ship":{canEquip:function(a,b,c){return b.hull<=3}},"tech:ion_thrusters_3rd_wing_attack_ship":{canEquip:d("Ion Thrusters")},"talent:self_destruct_sequence_71523":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"talent:experimental_link_71522":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"borg",c,d)}},"borg:transwarp_conduit_71522":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"borg",c,d)}},"talent:unnecessary_bloodshed_71524":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"dominion",c,d)}},"weapon:photon_torpedoes_71522":{attack:function(a,c,d){return c&&b.hasFaction(c,"borg",c,d)?6:5}},"weapon:forward_weapons_array_71522":{cost:function(a,c,d){return c&&!b.hasFaction(c,"borg",c,d)?11:6}},"weapon:volley_of_torpedoes_71524":{canEquip:function(a,b,c){return"Jem'Hadar Battleship"==b["class"]||"Jem'Hadar Battle Cruiser"==b["class"]}},"tech:combat_vessel_variant_71508":{canEquip:function(a,b,c){return"Suurok Class"==b["class"]},intercept:{ship:{attack:function(a,b,c,d){return"ship"==a.type&&(d instanceof Function&&(d=d(a,b,c,0)),d++),d},hull:function(a,b,c,d){return"ship"==a.type&&(d instanceof Function&&(d=d(a,b,c,0)),d++),d}}}},"tech:mutli_adaptive_shields_71509":{name:"Multi-Adaptive Shields",canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"tech:reinforced_structural_integrity_71509":{cost:function(a,b,c){return b&&"U.S.S. Raven"!=b.name?10:5}},"crew:quark_71786":{upgradeSlots:[{type:["weapon","tech"],source:"Quark (Non-Borg, 5SP or less)",intercept:{ship:{canEquip:function(a,c,d){var e=a.cost instanceof Function?a.cost(a,c,d,0):a.cost;return b.match(a,c)||(e+=a.factionPenalty instanceof Function?a.factionPenalty(a,c,d):a.factionPenalty),5>=e},canEquipFaction:function(a,c,d){return!b.hasFaction(a,"borg",c,d)},cost:function(){return 0},factionPenalty:function(){return 0}}}}]},"crew:vic_fontaine_crew_71786":{factionPenalty:function(a,c,d){return c&&b.hasFaction(c,"federation",c,d)?0:1}},"tech:vic_fontaine_tech_71786":{factionPenalty:function(a,c,d){return b.hasFaction(c,"federation",c,d)?0:1}},"crew:t_rul_71786":{upgradeSlots:[{type:["tech"],source:"T'Rul"}]},"crew:elim_garak_71786":{talents:1,upgradeSlots:[{type:["talent"],source:"Elim Garak (No Faction Penalty)",intercept:{ship:{factionPenalty:function(){return 0}}}}],factionPenalty:0},"tech:enhanced_hull_plating_71526":{canEquip:d("Enhanced Hull Plating"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"crew:t_pol_71526":{upgradeSlots:[{type:["tech"],source:"T'Pol"}],factionPenalty:function(a,c,d){return b.hasFaction(c,"vulcan",c,d)?0:1}},"crew:vulcan_commandos_71527":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"vulcan",c,d)}},"tech:combat_vessel_variant_71527":{upgradeSlots:[{type:["weapon"],source:"Combat Vessel Variant"}],canEquip:function(a,b,c){return"Suurok Class"!=b["class"]?!1:d("Combat Vessel Variant")(a,b,c)},intercept:{ship:{attack:function(a,b,c,d){return"ship"==a.type&&(d instanceof Function&&(d=d(a,b,c,0)),d++),d},hull:function(a,b,c,d){return"ship"==a.type&&(d instanceof Function&&(d=d(a,b,c,0)),d++),d},canEquip:function(a,b,c){return"Combat Vessel Variant"!=a.name}}}},"crew:third_of_five_71525":{canEquip:function(b,c,d){return!a("fleetCardNamed")(d,"Hugh")},intercept:{fleet:{canEquip:function(a,b,c,d){return"Hugh"==a.name?!1:d},canEquipCaptain:function(a,b,c,d){return"Hugh"==a.name?!1:d}}}},"borg:scavenged_parts_71525":{canEquip:d("Scavenged Parts")},"weapon:magnetometric_guided_charge_71525":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"borg")}},"weapon:tactical_station_71510":{upgradeSlots:[{type:["weapon"],source:"Tactical Station"}]},"weapon:fire_all_weapons_71510b":{cost:function(a,b,c){return b?"Galaxy Class"==b["class"]||"Intrepid Class"==b["class"]||"Sovereign Class"==b["class"]?7:12:7}},"tech:thought_maker_71646a":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"ferengi",c,d)}},"talen:vengeance_71646a":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"ferengi",c,d)&&b.hasFaction(c,"ferengi",c,d)}},"tech:cloaking_device_71646b":{cost:function(a,c,d){return c&&!b.hasFaction(c,"mirror-universe",c,d)?9:4}},"tech:tractor_beam_71646c":{canEquip:d("Tractor Beam")},"talent:vulcan_logic_71646e":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"vulcan",c,d)&&b.hasFaction(c,"vulcan",c,d)}},"weapon:photonic_charges_71646c":{cost:function(a,b,c){return b&&"Predator Class"!=b["class"]?8:4}},"weapon:proton_beam_71646d":{name:"Proton Beam",cost:function(a,c,d){return c&&!b.hasFaction(c,"borg",c,d)?9:4}},"borg:hive_mind_71511":{canEquip:d("Hive Mind")},"talent:borg_alliance_71511":{canEquipFaction:function(a,c,d){return c.captain&&!b.hasFaction(c.captain,"borg",c,d)&&!b.hasFaction(c,"borg",c,d)},upgradeSlots:[{type:["borg"],source:"Borg Alliance"}]},"tech:advanced_shields_71531":{canEquip:d("Advanced Shields")},"crew:william_t_riker_71531":{upgradeSlots:[{type:["crew"],source:"William T. Riker"}]},"borg:transwarp_signal_71530":{canEquip:d("Transwarp Signal"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"borg",c,d)}},"borg:borg_shield_matrix_71530":{canEquip:d("Borg Shield Matrix")},"weapon:ramming_attack_71528":{canEquip:function(a,b,c){return b.hull<=3}},"weapon:photon_torpedoes_71531":{attack:function(a,b,c){return b&&"Sovereign Class"==b["class"]?6:5}},"weapon:dorsal_phaser_array_71531":{cost:function(a,b,c){return b?b.attack+1:0},attack:function(a,b,c){return b?b.attack:0},canEquip:function(a,c,d){return b.hasFaction(c,"federation",c,d)&&c.hull>=4}},"weapon:multi_kinetic_neutronic_mines_71530":{cost:function(a,c,d){return c&&!b.hasFaction(c,"borg",c,d)?15:10}},"borg:data_node_71512":{canEquip:d("Data Node")},"talent:warrior_spirit_71512":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"klingon",c,d)}},"borg:command_interface_71513a":{cost:function(a,c,d){return c&&!b.hasFaction(c,"borg",c,d)?10:5}},"borg:interplexing_beacon_71513a":{canEquip:d("Interplexing Beacon")},"tech:prototype_cloaking_device_71532":{canEquip:function(a,b,c){return"Klingon Bird-of-Prey"==b["class"]}},"talent:cry_havoc_71532":{canEquipFaction:function(a,c,d){return c.captain&&b.hasFaction(c.captain,"klingon",c,d)}},"crew:jennifer_sisko_71529":{upgradeSlots:[{type:["tech"],source:"Jennifer Sisko"}]},"talent:shinzon_romulan_talents_71533":{upgradeSlots:[{type:["talent"],source:"Shinzon (Romulan Talent Only)",intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(a){return b.hasFaction(a,"romulan",ship,fleet)}}}},{type:["talent"],source:"Shinzon (Romulan Talent Only)",intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(a){return b.hasFaction(a,"romulan",ship,fleet)}}}},{type:["talent"],source:"Shinzon (Romulan Talent Only)",intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(a){return b.hasFaction(a,"romulan",ship,fleet)}}}},{type:["talent"],source:"Shinzon (Romulan Talent Only)",intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(a){return b.hasFaction(a,"romulan",ship,fleet)}}}}],canEquip:function(a,b,c){return b.captain&&"Shinzon"==b.captain.name},factionPenalty:0},"tech:secondary_shields_71533":{canEquip:function(a,b,c){return"Reman Warbird"==b["class"]}},"tech:improved_cloaking_device_71533":{cost:function(a,b,c){return b&&"Reman Warbird"!=b["class"]?10:5}},"weapon:thalaron_weapon_71533":{canEquip:function(a,b,c){return"Reman Warbird"==b["class"]}},"weapon:photon_torpedoes_71533":{attack:function(a,b,c){return b&&"Reman Warbird"==b["class"]?7:5}},"weapon:hypothermic_charge_71534":{canEquip:function(a,b,c){return b["class"].indexOf("Vidiian")>=0}},"squadron:cover_fire_71754":{canEquip:d("Cover Fire")},"squadron:flanking_attack_71754":{canEquip:d("Flanking Attack")},"squadron:support_ship_71754":{canEquip:d("Support Ship")},"squadron:aft_disruptor_wave_cannons_71754":{canEquip:d("Aft Disruptor Wave Cannons")},"squadron:galor_class_phaser_banks_71754":{canEquip:d("Galor Class Phaser Banks")},"talent:truce_71513b":{cost:function(a,b,c){return b&&b.captain&&b.captain.skill>5?10:5}},"crew:elim_garak_71535":{intercept:{ship:{skill:function(a,c,d,e){return a==c.captain&&b.hasFaction(c,"mirror-universe",c,d)&&(e=(e instanceof Function?e(a,c,d,0):e)+2),e}}}},"tech:cloaking_device_71535":{cost:function(a,b,c){return b&&"Regent's Flagship"!=b.name?9:4}},"weapon:photon_torpedoes_71535":{attack:function(a,b,c){return b&&"Negh'var Class"==b["class"]?6:5}},"tech:monotanium_armor_plating_71808":{canEquip:d("Monotanium Armor Plating")},"tech:sensor_network_71808":{canEquip:function(a,b,c){return b["class"].indexOf("Hirogen")>=0}},"talent:intercept_course_71808":{canEquip:function(a,b,c){return b["class"].indexOf("Hirogen")>=0},cost:function(a,b,c){return b&&b.captain&&"Karr"!=b.captain.name&&b.captain.name.indexOf("Hirogen")<0?9:4}},"weapon:subnucleonic_beam_71808":{cost:function(a,b,c){return b&&b["class"].indexOf("Hirogen")<0?10:5}},"squadron:defensive_maneuvers_71753":{canEquip:d("Defensive Maneuvers")},"squadron:support_ship_71753":{canEquip:d("Support Ship")},"squadron:attack_wave_71753":{canEquip:d("Attack Wave")},"squadron:attack_formation_71753":{canEquip:d("Attack Formation")},"squadron:cover_fire_71753":{canEquip:d("Cover Fire")},"squadron:coordinated_attack_71753":{canEquip:d("Coordinated Attack")},"tech:maneuvering_thrusters_71536":{cost:function(a,b,c){return b&&"Romulan Drone Ship"!=b["class"]?8:3}},"tech:multi_spectral_emitters_71536":{canEquip:function(a,b,c){return"Romulan Drone Ship"==b["class"]}},"tech:backup_sequencer_71536":{canEquip:function(a,b,c){return"Romulan Drone Ship"==b["class"]}},"weapon:triphasic_emitter_71536":{upgradeSlots:[{type:["weapon"],source:"Triphasic Emitter (Non-Borg, 5SP or less)",intercept:{ship:{cost:function(){return 0},factionPenalty:function(){return 0},canEquip:function(a,c,d){return!b.hasFaction(a,"borg",c,d)&&a.cost<=5}}}}]},"crew:william_t_riker_71996":{talents:1,factionPenalty:function(a,c,d){return c&&b.hasFaction(c,"klingon",c,d)?0:1},upgradeSlots:[{type:["talent"],source:"William T. Riker"}]},"tech:tunneling_neutrino_beam_71996":{factionPenalty:function(a,c,d){return c&&b.hasFaction(c,"klingon",c,d)?0:1}},"weapon:phaser_array_retrofit_71996":{canEquip:d("Phaser Array Retrofit")},"crew:turanj_71808":{upgradeSlots:[{type:["weapon"],source:"Turanj"}]},"talent:tholian_assembly_71795":{canEquipFaction:function(a,b,c){return b["class"].indexOf("Tholian")>=0&&b.captain&&("Loskene"==b.captain.name||b.captain.name.indexOf("Tholian")>=0)}},"crew:karden_71793":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"kazon",c,d)}},"crew:haliz_71793":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"kazon",c,d)}},"talent:first_maje_71793":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"kazon",c,d)&&c.captain&&b.hasFaction(c.captain,"kazon",c,d)}},"crew:romulan_helmsman_71794":{canEquip:d("Romulan Helmsman")},"talent:make_them_see_us__71794":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"romulan",c,d)&&c.captain&&b.hasFaction(c.captain,"romulan",c,d)}},"crew:romulan_sub_lieutenant_71794":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"romulan",c,d)}},"crew:romulan_security_officer_71794":{intercept:{ship:{skill:function(a,b,c,d){return a==b.captain&&(d=(d instanceof Function?d(a,b,c,0):d)+1),d}}}},"weapon:tricobalt_warhead_71795":{cost:function(a,b,c){return b&&b["class"].indexOf("Tholian")<0?9:4}},"weapon:disruptor_pulse_71794":{cost:function(a,c,d){return c&&!b.hasFaction(c,"romulan",c,d)?10:5}},"tech:improved_deflector_screens_71797":{canEquip:function(a,b,c){return b.hull<=3&&d("Improved Deflector Screens")(a,b,c)}},"weapon:targeted_phaser_strike_71797":{cost:function(a,b,c){return b&&"Gorn Raider"!=b["class"]?8:4}},"talent:coded_messages_71798":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"dominion",c,d)}},"weapon:aft_weapons_array_71798":{canEquip:function(a,b,c){return b.hull>=4},canEquipFaction:function(a,c,d){return b.hasFaction(c,"dominion",c,d)}},"crew:marlena_moreau_71796":{cost:function(b,d,e){if(!d)return 3;var f=!1,g=0;return $.each(a("upgradeSlots")(d),function(a,h){if(h.occupant&&h.occupant!=b&&"talent"==h.occupant.type){var i=c(h.occupant,"cost",d,e);if(i>0)return f=h.occupant,g=i,!1}}),g>0?2:3}},"talent:tantalus_field_71796":{canEquip:function(a,b,c){return"I.S.S. Enterprise"==b.name}},"tech:escape_transporter_71997p":{canEquip:function(a,b,c){return b["class"].indexOf("Shuttlecraft")>=0},canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"tech:warp_drive_71997p":{canEquip:function(a,b,c){return b["class"].indexOf("Shuttlecraft")>=0&&d("Warp Drive")(a,b,c)},canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"captain:annorax_71799":{upgradeSlots:[{},{type:["tech"],source:"Annorax"}]},"talent:causality_paradox_71799":{canEquipFaction:function(a,b,c){return"Krenim Weapon Ship"==b["class"]&&b.captain&&("Annorax"==b.captain.name||"Obrist"==b.captain.name||b.captain.name.indexOf("Krenim")>=0)}},"weapon:chroniton_torpedoes_71799":{cost:function(a,b,c){return b&&"Krenim Weapon Ship"!=b["class"]?12:6}},"weapon:temporal_incursion_71799":{canEquip:function(a,b,c){return"Krenim Weapon Ship"==b["class"]}},"tech:temporal_wave_front_71799":{canEquip:function(a,b,c){return"Krenim Weapon Ship"==b["class"]}},"tech:temporal_core_71799":{canEquip:function(a,b,c){return"Krenim Weapon Ship"==b["class"]}},"tech:spatial_distortion_71799":{canEquip:function(a,b,c){return"Krenim Weapon Ship"==b["class"]}},"captain:soval_71800":{intercept:{ship:{factionPenalty:function(a,b,c,d){return"captain"!=a.type&&"admiral"!=a.type?0:d;
}}}},"crew:orion_tactical_officer_71800":{canEquip:d("Orion Tactical Officer")},"crew:andorian_helmsman_71800":{canEquip:d("Andorian Helmsman")},"tech:enhanced_hull_plating_71800":{canEquip:d("Enhanced Hull Plating"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"mirror-universe",c,d)&&c.hull<=4}},"ship:u_s_s_pegasus_71801":{intercept:{ship:{cost:function(a,b,c,d){return"tech"==a.type&&(d=d instanceof Function?d(a,b,c,0):d,d>0&&(d-=1)),d}}}},"tech:specialized_shields_71801":{canEquip:function(a,b,c){return b.hull<=3},canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"tech:phasing_cloaking_device_71801":{cost:function(a,b,c){return b&&"Oberth Class"!=b["class"]?10:5}},"crew:eric_motz_71801":{upgradeSlots:[{type:["tech"],source:"Eric Motz"}]},"crew:william_t_riker_71801":{intercept:{ship:{skill:function(a,b,c,d){return a==b.captain&&(d=d instanceof Function?d(a,b,c,0):d,d+=3),d}}}},"captain:krim_71803":{upgradeSlots:[{},{type:["crew"],source:"Krim"}]},"captain:jaro_essa_cap_71803":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"bajoran",c,d)}},"admiral:jaro_essa_71803":{canEquipAdmiral:function(a,c,d){return b.hasFaction(c,"bajoran",c,d)}},"tech:assault_vessel_upgrade_t_71803":{type:"question",isSlotCompatible:function(a){return $.inArray("tech",a)>=0||$.inArray("weapon",a)>=0||$.inArray("crew",a)>=0},canEquip:function(a,b,c){return"Bajoran Scout Ship"==b["class"]?d("Assault Vessel Upgrade")(a,b,c):!1},intercept:{ship:{attack:function(a,b,c,d){return a==b&&(d+=1),d},shields:function(a,b,c,d){return a==b&&(d+=1),d}}}},"crew:bajoran_militia_71803":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"bajoran",c,d)}},"captain:kurn_71999p":{upgradeSlots:[{type:["talent"],source:"Kurn (Mauk-to'Vor Only at 3SP)",canEquip:function(a,b,c){return"Mauk-to'Vor"==a.name},intercept:{ship:{cost:function(){return 3}}}}],factionPenalty:function(){return 0}},"crew:klingon_stealth_team_71999p":{canEquip:d("Klingon Stealth Team"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"klingon",c,d)}},"talent:mauk_to_vor_71999p":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"klingon",c,d)&&b.hasFaction(c.captain,"klingon",c,d)}},"weapon:ambush_attack_71999p":{canEquip:d("Ambush Attack")},"tech:systems_upgrade_71998p":{type:"question",isSlotCompatible:function(a){return $.inArray("tech",a)>=0||$.inArray("weapon",a)>=0||$.inArray("crew",a)>=0},upgradeSlots:[{type:["tech"],source:"Systems Upgrade"}],intercept:{ship:{shields:function(a,b,c,d){return d+1}}},canEquip:d("Systems Upgrade"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"crew:systems_upgrade_c_71998p":{upgradeSlots:[{type:["tech"],source:"Systems Upgrade"}],intercept:{ship:{shields:function(a,b,c,d){return d+1}}},canEquip:d("Systems Upgrade"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"weapon:systems_upgrade_w_71998p":{upgradeSlots:[{type:["tech"],source:"Systems Upgrade"}],intercept:{ship:{shields:function(a,b,c,d){return d+1}}},canEquip:d("Systems Upgrade"),canEquipFaction:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"weapon:type_8_phaser_array_71998p":{canEquip:function(a,b,c){return b.attack<=3?d("Type 8 Phaser Array")(a,b,c):!1}},"resource:fleet_captain_collectiveop2":{slotType:"fleet-captain",cost:0,hideCost:!0,showShipResourceSlot:function(a,b,c){if(b.resource&&"fleet-captain"==b.resource.type)return!0;var d=!0;return $.each(c.ships,function(a,b){b.resource&&(d=!1)}),d},onRemove:function(a,b,c){$.each(c.ships,function(a,b){b.resource&&delete b.resource})}},"fleet-captain:federation_collectiveop2":{canEquip:function(a,c,d){return b.hasFaction(c,"federation",c,d)&&(!c.captain||c.captain.unique&&b.hasFaction(c.captain,"federation",c,d))},intercept:{ship:{canEquipCaptain:function(a,c,d){return a.unique&&b.hasFaction(a,"federation",c,d)}}}},"fleet-captain:dominion_collectiveop2":{canEquip:function(a,c,d){return b.hasFaction(c,"dominion",c,d)&&(!c.captain||c.captain.unique&&b.hasFaction(c.captain,"dominion",c,d))},intercept:{ship:{canEquipCaptain:function(a,c,d){return a.unique&&b.hasFaction(a,"dominion",c,d)}}}},"fleet-captain:romulan_collectiveop2":{canEquip:function(a,c,d){return b.hasFaction(c,"romulan",c,d)&&(!c.captain||c.captain.unique&&b.hasFaction(c.captain,"romulan",c,d))},intercept:{ship:{canEquipCaptain:function(a,c,d){return a.unique&&b.hasFaction(a,"romulan",c,d)}}}},"fleet-captain:klingon_collectiveop2":{canEquip:function(a,c,d){return b.hasFaction(c,"klingon",c,d)&&(!c.captain||c.captain.unique&&b.hasFaction(c.captain,"klingon",c,d))},intercept:{ship:{canEquipCaptain:function(a,c,d){return a.unique&&b.hasFaction(a,"klingon",c,d)}}}},"fleet-captain:independent_klingon_collectiveop2":{canEquip:function(a,b,c){return!b.captain||b.captain.unique},intercept:{ship:{canEquipCaptain:function(a,b,c){return a.unique},factions:function(a,b,c,d){return d=d||a.factions,a==b.captain&&d.indexOf("independent")<0?d.concat(["independent"]):d}},fleet:{cost:function(a,b,c,d){return"crew"==a.type?(d instanceof Function?d(a,b,c,0):d)-1:d}}}},"fleet-captain:independent_federation_collectiveop2":{canEquip:function(a,b,c){return!b.captain||b.captain.unique},intercept:{ship:{canEquipCaptain:function(a,b,c){return a.unique},factions:function(a,b,c,d){return d=d||a.factions,a==b.captain&&d.indexOf("independent")<0?d.concat(["independent"]):d}},fleet:{}}},"fleet-captain:independent_romulan_collectiveop2":{canEquip:function(a,b,c){return!b.captain||b.captain.unique},intercept:{ship:{canEquipCaptain:function(a,b,c){return a.unique},factions:function(a,b,c,d){return d=d||a.factions,a==b.captain&&d.indexOf("independent")<0?d.concat(["independent"]):d}},fleet:{cost:function(a,b,c,d){return"weapon"==a.type?(d instanceof Function?d(a,b,c,0):d)-1:d}}}},"fleet-captain:independent_dominion_collectiveop2":{canEquip:function(a,b,c){return!b.captain||b.captain.unique},intercept:{ship:{canEquipCaptain:function(a,b,c){return a.unique},factions:function(a,b,c){var d=a.factions;return a==b.captain&&d.indexOf("independent")<0?d.concat(["independent"]):d}},fleet:{cost:function(a,b,c,d){return"tech"==a.type?(d instanceof Function?d(a,b,c,0):d)-1:d}}}},"resource:officer_exchange_program_71996a":{upgradeSlots:[{type:["faction"],source:"Select Factions for Officer Exchange Program"},{type:["faction"],source:"Select Factions for Officer Exchange Program"}],intercept:{fleet:{factionPenalty:function(a,c,d,e){var f=d.resource.upgradeSlots[0].occupant,g=d.resource.upgradeSlots[1].occupant;return f&&g?"captain"!=a.type&&"admiral"!=a.type&&"crew"!=a.type?e:b.match(a,f)&&b.match(c,g)||b.match(a,g)&&b.match(c,f)?0:e:e},cost:function(a,c,d,e){var f=d.resource.upgradeSlots[0].occupant,g=d.resource.upgradeSlots[1].occupant;return f&&g?"captain"!=a.type&&"admiral"!=a.type?e:b.match(a,f)&&b.match(c,g)||b.match(a,g)&&b.match(c,f)?(e instanceof Function?e(a,c,d,0):e)-1:e:e}}}},"resource:officer_cards_collectiveop3":{hideCost:!0,intercept:{fleet:{type:function(a,b,c,d){return $.inArray("crew",d)>=0?d.concat(["officer"]):d}}}},"officer:first_officer_collectiveop3":{skill:4,talents:1,upgradeSlots:[{},{type:["talent"],source:"First Officer"}]},"officer:tactical_officer_collectiveop3":{upgradeSlots:[{},{type:["weapon"],source:"Tactical Officer"}]},"officer:operations_officer_collectiveop3":{upgradeSlots:[{},{type:["crew"],source:"Operations Officer"}]},"officer:science_officer_collectiveop3":{upgradeSlots:[{},{type:["tech"],source:"Science Officer"}]},"resource:4003":{upgradeSlots:[{type:["talent"],source:"Sideboard",canEquip:function(a,b,c,d){var e=0;$.each(c.resource.upgradeSlots,function(a,b){b.occupant&&b!=d&&(e+=b.occupant.cost instanceof Function?b.occupant.cost():b.occupant.cost)});var f=a.cost instanceof Function?a.cost():a.cost;return 20>=e+f},intercept:{ship:{canEquip:function(){return!0},canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}},{type:["crew"],source:"Sideboard",canEquip:function(a,b,c,d){var e=0;$.each(c.resource.upgradeSlots,function(a,b){b.occupant&&b!=d&&(e+=b.occupant.cost instanceof Function?b.occupant.cost():b.occupant.cost)});var f=a.cost instanceof Function?a.cost():a.cost;return 20>=e+f},intercept:{ship:{canEquip:function(){return!0},canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}},{type:["tech"],source:"Sideboard",canEquip:function(a,b,c,d){var e=0;$.each(c.resource.upgradeSlots,function(a,b){b.occupant&&b!=d&&(e+=b.occupant.cost instanceof Function?b.occupant.cost():b.occupant.cost)});var f=a.cost instanceof Function?a.cost():a.cost;return 20>=e+f},intercept:{ship:{canEquip:function(){return!0},canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}},{type:["weapon"],source:"Sideboard",canEquip:function(a,b,c,d){var e=0;$.each(c.resource.upgradeSlots,function(a,b){b.occupant&&b!=d&&(e+=b.occupant.cost instanceof Function?b.occupant.cost():b.occupant.cost)});var f=a.cost instanceof Function?a.cost():a.cost;return 20>=e+f},intercept:{ship:{canEquip:function(){return!0},canEquipFaction:function(){return!0},factionPenalty:function(){return 0}}}}]},"resource:4004":{slotType:"flagship",cost:0,hideCost:!0,showShipResourceSlot:function(a,b,c){if(b.resource&&"flagship"==b.resource.type)return!0;var d=!0;return $.each(c.ships,function(a,b){b.resource&&(d=!1)}),d},onRemove:function(a,b,c){$.each(c.ships,function(a,b){b.resource&&delete b.resource})}},"flagship:6001":{canEquip:function(a,c,d){return b.hasFaction(c,"romulan",c,d)}},"flagship:6003":{canEquip:function(a,c,d){return b.hasFaction(c,"klingon",c,d)}},"flagship:6005":{canEquip:function(a,c,d){return b.hasFaction(c,"dominion",c,d)}},"flagship:6007":{canEquip:function(a,c,d){return b.hasFaction(c,"federation",c,d)}},"flagship:6002":{intercept:{ship:{factions:function(a,b,c){var d=a.factions;return a==b&&d.indexOf("independent")<0?d.concat(["independent"]):d}}}},"flagship:6004":{intercept:{ship:{factions:function(a,b,c){var d=a.factions;return a==b&&d.indexOf("independent")<0?d.concat(["independent"]):d}}}},"flagship:6006":{intercept:{ship:{factions:function(a,b,c){var d=a.factions;return a==b&&d.indexOf("independent")<0?d.concat(["independent"]):d}}}},"flagship:6008":{intercept:{ship:{factions:function(a,b,c){var d=a.factions;return a==b&&d.indexOf("independent")<0?d.concat(["independent"]):d}}}},"captain:kor_71804":{upgradeSlots:[{},{type:["crew"],source:"Kor"}]},"crew:romulan_hijackers_71802":{canEquip:function(c,d,e){if(d.captain&&!b.hasFaction(d.captain,"romulan",d,e))return!1;var f=!0;return $.each(a("upgradeSlots")(d),function(a,c){c.occupant&&"crew"==c.occupant.type&&!b.hasFaction(c.occupant,"romulan",d,e)&&(f=!1)}),f},intercept:{ship:{canEquip:function(a,c,d){return"crew"!=a.type||b.hasFaction(a,"romulan",c,d)?!0:!1},canEquipCaptain:function(a,c,d){return b.hasFaction(a,"romulan",c,d)},cost:function(a,c,d,e){return"tech"!=a.type&&"weapon"!=a.type||b.hasFaction(a,"borg",c,d)||(e=(e instanceof Function?e(a,c,d,0):e)-1),e},factionPenalty:function(a,c,d,e){return"captain"!=a.type&&"admiral"!=a.type&&b.hasFaction(a,"romulan",c,d)?0:e}}}},"crew:darok_71804":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"klingon",c,d)}},"tech:inverse_graviton_burst_71804":{cost:function(a,c,d){return c&&!b.hasFaction(c,"klingon",c,d)?10:5}},"talent:long_live_the_empire__71804":{canEquip:function(a,c,d){return b.hasFaction(c,"klingon",c,d)&&(!c.captain||b.hasFaction(c.captain,"klingon",c,d))},intercept:{ship:{canEquipCaptain:function(a,c,d){return b.hasFaction(a,"klingon",c,d)}}}},"tech:regenerative_shielding_71802":{cost:function(a,b,c){return b&&"U.S.S. Prometheus"!=b.name?8:4},canEquip:d("Regenerative Shielding")},"tech:ablative_hull_armor_71802":{canEquip:function(a,b,c){return"Prometheus Class"==b["class"]}},"weapon:multi_vector_assault_mode_71802":{canEquip:function(a,b,c){return"Prometheus Class"==b["class"]}},"captain:arturis_71805":{skill:function(a,b,c){return b&&"Dauntless Class"==b["class"]?8:3}},"tech:auto_navigation_71805":{skill:function(a,b,c){return b&&!b.captain?2:void 0},upgradeSlots:[{type:["tech"],source:"Auto-Navigation"}]},"tech:force_field_71805":{cost:function(a,b,c){return b&&"Dauntless Class"!=b["class"]?8:3}},"tech:navigational_deflector_71805":{canEquip:d("Navigational Deflector")},"tech:particle_synthesis_71805":{canEquip:function(a,b,c){return"Dauntless Class"==b["class"]}},"weapon:additional_phaser_array_72000p":{canEquip:function(a,b,c){return"D'deridex Class"==b["class"]?d("Additional Phaser Array")(a,b,c):!1}},"tech:long_range_scanners_72000p":{cost:function(a,b,c){return b&&"D'deridex Class"!=b["class"]?6:3}},"talent:marauder_71806":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"ferengi",c,d)&&b.hasFaction(c.captain,"ferengi",c,d)}},"talent:acquisition_71806":{canEquipFaction:function(a,c,d){return b.hasFaction(c,"ferengi",c,d)&&b.hasFaction(c.captain,"ferengi",c,d)}},"crew:tactical_officer_71806":{canEquip:d("Tactical Officer")},"tech:ferengi_probe_71806":{canEquip:d("Ferengi Probe")},"tech:inverse_tachyon_pulse_71807":{canEquip:d("Inverse Tachyon Pulse")}}}]);var module=angular.module("utopia-card-ship",[]);module.filter("icons",function(){return function(a){return a.replace(/\[([^\]]*)\]/g,"<i class='fs fs-$1'></i>").replace(/\n/g,"<br/>")}}),module.directive("cardShip",function(){return{scope:{ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-ship.html",controller:["$scope",function(a){}]}});var module=angular.module("utopia-card-upgrade",[]);module.filter("upgradeSlots",function(){return function(a){var b=[];a.resource&&a.resource.upgradeSlots&&(b=b.concat(a.resource.upgradeSlots)),a.captain&&a.captain.upgradeSlots&&(b=b.concat(a.captain.upgradeSlots)),a.admiral&&a.admiral.upgradeSlots&&(b=b.concat(a.admiral.upgradeSlots)),b=b.concat(a.upgrades).concat(a.upgradeSlots);for(var c=[];b.length>0;){var d=b.shift();d&&(c.push(d),d.occupant&&d.occupant.upgradeSlots&&(b=d.occupant.upgradeSlots.concat(b)))}return c}}),module.filter("shipInterceptors",["$filter",function(a){var b=a("upgradeSlots");return function(a,c,d,e,f){var g=[],h=b(c);return $.each(h,function(b,c){c.occupant&&c.occupant.intercept[d][e]&&g.push(c.occupant.intercept[d][e]),(f&&c==f||a==c.occupant)&&c.intercept&&c.intercept[d]&&c.intercept[d][e]&&g.push(c.intercept[d][e])}),c.resource&&c.resource.intercept[d][e]&&g.push(c.resource.intercept[d][e]),c.captain&&c.captain.intercept[d][e]&&g.push(c.captain.intercept[d][e]),c.admiral&&c.admiral.intercept[d][e]&&g.push(c.admiral.intercept[d][e]),c.intercept&&c.intercept[d][e]&&g.push(c.intercept[d][e]),g}}]),module.filter("interceptors",["$filter",function(a){var b=a("shipInterceptors");return function(a,c,d,e,f){var g=[];return c&&(g=g.concat(b(a,c,"ship",e,f))),d&&($.each(d.ships||[],function(c,d){g=g.concat(b(a,d,"fleet",e))}),d.resource&&(g=g.concat(b(a,d.resource,"fleet",e)))),g}}]),module.filter("valueOf",["$filter",function(a){var b=a("interceptors");return function(a,c,d,e,f){return data=a[c],d&&$.each(b(a,d,e,c,f),function(b,c){data=c(a,d,e,data)}),data instanceof Function?data(a,d,e):data}}]),module.directive("cardUpgrade",function(){return{scope:{upgrade:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"="},templateUrl:"card-upgrade.html",controller:["$scope",function(a){a.range=function(a){return new Array(a)},a.isDefined=function(a){return void 0!==a}}]}});var module=angular.module("utopia-dragdrop",[]);module.directive("draggable",function(){return{scope:{dragItem:"=",dragStore:"=",dragSource:"="},link:function(a,b){b.prop("draggable",!0),b.on("dragstart",function(c){a.$apply(function(){a.dragStore.item=a.dragItem,a.dragStore.source=a.dragSource}),b.addClass("dragging"),c.originalEvent.dataTransfer.effectAllowed="move",c.originalEvent.dataTransfer.setData("text/plain","google")}),b.on("dragend",function(c){b.removeClass("dragging"),a.$apply(function(a){delete a.dragStore.item,delete a.dragStore.source})}),b.on("click",function(b){return a.$apply(function(){a.dragStore.item!=a.dragItem?(a.dragStore.item=a.dragItem,a.dragStore.source=a.dragSource):delete a.dragStore.item}),b.preventDefault(),!1})}}}),module.directive("droppable",function(){return{scope:{drop:"&",canDrop:"&",dragStore:"="},link:function(a,b){b.on("dragover",function(c){a.canDrop({$item:a.dragStore.item})&&(b.addClass("drag-over"),c.preventDefault())}),b.on("dragenter",function(c){a.canDrop({$item:a.dragStore.item})&&b.addClass("drag-over")}),b.on("dragleave",function(a){b.removeClass("drag-over")}),b.on("drop",function(c){b.removeClass("drag-over"),a.$apply(function(a){a.drop({$item:a.dragStore.item}),delete a.dragStore.item}),c.preventDefault()}),b.on("click",function(b){a.$apply(function(){a.dragStore.item&&(a.drop({$item:a.dragStore.item}),delete a.dragStore.item)}),b.preventDefault()})}}});var module=angular.module("utopia-fleet-builder",["utopia-card-upgrade","utopia-dragdrop"]);module.directive("fleetBuilder",["$filter",function(a){return{scope:{fleet:"=",cards:"=",searchOptions:"=",dragStore:"="},templateUrl:"fleet-builder.html",controller:["$scope","isMobile",function(b,c){function d(a,b){return b&&a.unique&&b.unique&&a.name==b.name&&a.mirror==b.mirror?b:!1}function e(a){if(!a)return{};var b={id:a.type+":"+a.id};a.resource&&(b.resource=e(a.resource)),a.captain&&(b.captain=e(a.captain)),a.admiral&&(b.admiral=e(a.admiral));var c=[];$.each(a.upgrades||[],function(a,b){var d={};b.occupant&&(d=e(b.occupant)),c.push(d)}),c.length>0&&(b.upgrades=c);var d=[];return $.each(a.upgradeSlots||[],function(a,b){var c={};b.occupant&&(c=e(b.occupant)),d.push(c)}),d.length>0&&(b.upgradeSlots=d),b}function f(a,c,d,e){var g=angular.copy(b.findCardById(c,d.id));if(!g)return console.log("unable to load card",d.id),!1;var h=function(g){if(d.resource){var h=f(a,c,d.resource,g);if(!h)return!1;var i=b.setShipResource(a,g,h.card);if(!i)return!1;h.promulgate(i)}if(d.captain){var h=f(a,c,d.captain,g);if(!h)return!1;var j=b.setShipCaptain(a,g,h.card);if(!j)return!1;h.promulgate(j)}if(d.admiral){var h=f(a,c,d.admiral,g);if(!h)return!1;var k=b.setShipAdmiral(a,g,h.card);if(!k)return!1;h.promulgate(k)}$.each(d.upgrades||[],function(d,e){if(e&&e.id){var h=f(a,c,e,g);if(!h)return!1;var i=b.setUpgrade(a,g,g.upgrades[d],h.card);if(!i)return!1;h.promulgate(i)}}),$.each(d.upgradeSlots||[],function(d,h){if(h&&h.id){var i=f(a,c,h,e||g);if(!i)return!1;var j=b.setUpgrade(a,e||g,g.upgradeSlots[d],i.card);if(!j)return!1;i.promulgate(j)}})};return{card:g,promulgate:h}}b.isMobile=c,b.$watch("fleet",function(a){location.hash=btoa(angular.toJson(b.saveFleet(a)))},!0),b.$on("removeFromFleet",function(a,c){b.removeFromFleet(c,b.fleet)}),b.setSearchTypes=function(a){$.each(b.searchOptions.types,function(b,c){c.search=$.inArray(b,a)>=0}),b.searchOptions.columns<1&&(b.searchOptions.columns=1)},b.addFleetShip=function(a,c){var d=b.findOtherInFleet(c,a),e=g(c,"canJoinFleet",c,a);return e?d&&d!=c?(console.log("upgrade uniquenes check failed"),!1):(d&&b.removeFromFleet(d,a),c=angular.copy(c),a.ships.push(c),c):(console.log("joinFleet stopped by interceptor"),!1)},b.getUpgradeSlots=a("upgradeSlots"),b.isUpgradeCompatible=function(a,b,c,d){if(a==b.occupant)return!1;var e=g(b,"type",c,d);return"question"==a.type?a.isSlotCompatible&&a.isSlotCompatible(e):$.inArray(a.type,e)>=0};var g=a("valueOf");b.setUpgrade=function(a,c,d,e){if(!b.isUpgradeCompatible(e,d,c,a))return console.log("wrong slot type"),!1;if(d.occupant==e)return!1;var f=g(e,"canEquip",c,a,d);if(!f)return console.log("equip stopped by special card rule"),!1;var h=g(e,"canEquipFaction",c,a,d);if(!h)return console.log("equip stopped by faction-specific special card rule"),!1;if(d.canEquip&&!d.canEquip(e,c,a,d))return console.log("upgrade rejected by slot"),!1;var i=b.findOtherInFleet(e,a);return i&&i!=e&&i!=d.occupant?(console.log("upgrade uniquenes check failed"),!1):(i&&i!=d.occupant&&b.removeFromFleet(i,a,d.occupant),d.occupant=angular.copy(e),g(d.occupant,"onEquip",c,a),d.occupant)},b.setShipResource=function(a,c,d){if(!a.resource||d.type!=a.resource.slotType)return!1;var e=g(d,"canEquip",c,a);if(!e)return console.log("equip stopped by special card rule"),!1;var f=b.findOtherInFleet(d,a);return f&&f!=upgrade&&f!=c.resource?(console.log("upgrade uniquenes check failed"),!1):(c.resource=angular.copy(d),c.resource)},b.setShipCaptain=function(a,c,d){if("captain"!=d.type)return console.log("card is not a captain"),!1;var e=g(d,"canEquipCaptain",c,a);if(!e)return console.log("equip stopped by interceptor"),!1;var f=b.findOtherInFleet(d,a);return f&&f!=d&&f!=c.captain?(console.log("captain already in fleet"),!1):(f&&f!=c.captain&&b.removeFromFleet(f,a,c.captain),c.captain=angular.copy(d),c.captain)},b.fleetHasAdmiral=function(a){var b=!1;return $.each(a.ships,function(a,c){return c.admiral?(b=!0,!1):void 0}),b},b.setShipAdmiral=function(a,c,d){if("admiral"!=d.type)return!1;var e=g(d,"canEquipAdmiral",c,a);if(!e)return console.log("equip stopped by interceptor"),!1;var f=b.findOtherInFleet(d,a);return f&&f!=d&&f!=c.admiral?(console.log("admiral already in fleet"),!1):(f&&f!=c.admiral&&b.removeFromFleet(f,a,c.admiral),c.admiral=angular.copy(d),c.admiral)},b.findOtherInFleet=function(a,c){var e=!1;return $.each(c.ships,function(c,f){return a==f||d(a,f)?(e=f,!1):a==f.captain||d(a,f.captain)?(e=f.captain,!1):a==f.admiral||d(a,f.admiral)?(e=f.admiral,!1):($.each(b.getUpgradeSlots(f),function(b,c){return a==c.occupant||d(a,c.occupant)?(e=c.occupant,!1):void 0}),e?!1:void 0)}),c.resource&&$.each(c.resource.upgradeSlots||[],function(b,c){return a==c.occupant||d(a,c.occupant)?(e=c.occupant,!1):void 0}),e},b.removeFromFleet=function(a,c,d){return a?(a==c.resource&&delete c.resource,c.resource&&$.each(c.resource.upgradeSlots||[],function(c,e){return a==e.occupant?(d&&b.isUpgradeCompatible(d,e)?e.occupant=d:delete e.occupant,found=!0,!1):void 0}),$.each(c.ships,function(e,f){if(a==f)return d&&"ship"==d.type?c.ships[e]=d:c.ships.splice(e,1),!1;if(a==f.resource)return delete f.resource,!1;if(a==f.captain)return d&&"captain"==d.type?f.captain=d:delete f.captain,!1;if(a==f.admiral)return d&&"admiral"==d.type?f.admiral=d:delete f.admiral,!1;var g=!1;return $.each(b.getUpgradeSlots(f),function(c,e){return a==e.occupant?(d&&b.isUpgradeCompatible(d,e)?e.occupant=d:delete e.occupant,g=!0,!1):void 0}),!g}),void g(a,"onRemove",{},c)):!1},b.getTotalCost=function(c,d){var e=a("valueOf"),f=c.cost;return c.resource&&(f+=e(c.resource,"cost",c,d)),c.captain&&(f+=e(c.captain,"cost",c,d)),c.admiral&&(f+=e(c.admiral,"cost",c,d)),$.each(b.getUpgradeSlots(c),function(a,b){b.occupant&&(f+=e(b.occupant,"cost",c,d))}),f},b.getFleetCost=function(a){var c=a.resource?a.resource.cost:0;return $.each(a.ships,function(d,e){c+=b.getTotalCost(e,a)}),c},b.setFleetResource=function(a,c){a.resource&&b.removeFromFleet(a.resource,a),a.resource=c},b.saveFleet=function(a){var b={ships:[]};return a.resource&&(b.resource=e(a.resource)),$.each(a.ships,function(a,c){b.ships.push(e(c))}),b},b.findCardById=function(a,b){var c=!1;return $.each(a,function(a,d){return d.type+":"+d.id==b?(c=d,!1):void 0}),c},b.loadFleet=function(a,c){var d={ships:[]};return c.resource&&(result=f(d,a,c.resource),result&&(d.resource=result.card,result.promulgate(d.resource))),$.each(c.ships,function(c,e){var g=f(d,a,e);if(g){var h=b.addFleetShip(d,g.card);h&&g.promulgate(h)}}),d};var h=!1;try{h=location.hash?angular.fromJson(atob(location.hash.substring(1))):!1}catch(i){}b.$on("cardsLoaded",function(){h&&(h=b.loadFleet(b.cards,h),h&&(b.fleet=h,b.fleet.ships.length>0&&($.each(h.ships,function(a,b){b.hideEmptySlots=!0}),b.searchOptions.columns=0)))})}]}}]);var module=angular.module("utopia-fleet-export",[]);module.directive("fleetExport",function(){return{scope:{fleet:"=",sets:"=",searchOptions:"="},templateUrl:"fleet-export.html",link:function(a,b){$(b).find("textarea").focus(function(){$this=$(this),$this.select(),window.setTimeout(function(){$this.select()},1),$this.mouseup(function(){return $this.unbind("mouseup"),!1})})},controller:["$scope","$filter",function(a,b){function c(b){var c="",d=0;if($.each(b.ships,function(a,f){var g=e(f,f,b);c+=g.text+"Ship Total: "+g.cost+" SP\n\n",d+=g.cost}),b.resource){var f=e(b.resource,{},b);c+="Resource: "+f.text+"\n",d+=f.cost}c+="Fleet Total: "+d+" SP\n\n",c+="Generated by Utopia\nhttp://comatoes.github.io/staw-utopia/",a.fleetText=c}function d(b){var c="";return $.each(b,function(d,e){c+=a.sets[e]?a.sets[e].name:e,d<b.length-1&&(c+=", ")}),c}function e(b,c,g,h,i){var j="";h=h||0;for(var k=0;h>k;k++)j+="- ";var l=f(b,"cost",c,g),m=!0;if("resource"==b.type&&(m=!1),j+=b.name,"captain"==b.type&&(j+=" "+b.skill+" (Captain)"),"admiral"==b.type&&(j+=" (Admiral)"),"fleet-captain"==b.type&&(j+=" Fleet Captain"),"flagship"==b.type&&(j+=" Flagship"),"faction"==b.type&&(j+=" Faction"),"ship"==b.type?j+=b.unique?"":" ("+b["class"]+")":a.showSetNames&&(j+=b.set?" ("+d(b.set)+")":""),i||(j+=" ["+l+"]"),j+="\n",b.resource){var n=e(b.resource,c,g,h+1);j+=n.text,l+=n.cost}if(b.captain){var n=e(b.captain,c,g,h+1);j+=n.text,l+=n.cost}if(b.admiral){var n=e(b.admiral,c,g,h+1);j+=n.text,l+=n.cost}return $.each(b.upgrades||[],function(a,b){if(b.occupant){var d=e(b.occupant,c,g,h+1);j+=d.text,m&&(l+=d.cost)}}),$.each(b.upgradeSlots||[],function(a,b){if(b.occupant){var d=e(b.occupant,c,g,h+1,!m);j+=d.text,m&&(l+=d.cost)}}),{cost:l,text:j}}a.fleetText="",a.showSetNames=!1;var f=b("valueOf");a.$watch("fleet",function(a){c(a)},!0),a.$watch("showSetNames",function(){c(a.fleet)})}]}});var module=angular.module("utopia",["ngSanitize","utopia-card-ship","utopia-card-upgrade","utopia-card-resource","utopia-dragdrop","utopia-fleet-builder","utopia-fleet-export","utopia-card-loader","utopia-card-rules"]);module.filter("cardFilter",["$factions","$filter",function(a,b){return function(c,d){var e=b("valueOf");return $.map(c,function(b){if(d.unique&&!b.unique&&!d.generic)return null;if(d.generic&&b.unique&&!d.unique)return null;if(b.set&&!d.ignoreSetsFilter&&d.sets){var c=!1;if($.each(b.set,function(a,b){d.sets[b].search&&(c=!0)}),!c)return null}if(d.filterField&&d.filterOperator&&d.filterValue){var f=e(b,d.filterField);if(!f)return null;switch(d.filterOperator){case"<":if(f>=d.filterValue)return null;break;case"<=":if(f>d.filterValue)return null;break;case"=":if(f!=d.filterValue)return null;break;case">=":if(f<d.filterValue)return null;break;case">":if(f<=d.filterValue)return null}}if(d.query&&b.name.toLowerCase().indexOf(d.query.toLowerCase())<0&&(!b["class"]||b["class"].toLowerCase().indexOf(d.query.toLowerCase())<0)&&b.text.toLowerCase().indexOf(d.query.toLowerCase())<0)return null;var g=!0;if($.each(d.types,function(a,b){return b.search?(g=!1,!1):void 0}),!g&&!d.types[b.type].search)return null;if("resource"==b.type)return b;var g=!0,h=!1;return $.each(d.factions,function(c,d){d.search&&(g=!1,h|=a.hasFaction(b,c))}),g||h?b:null})}}]),module.filter("shipCardNamed",["$filter",function(a){var b=a("upgradeSlots");return function(a,c){if(a.name==c)return a;if(a.captain&&a.captain.name==c)return a.captain;var d=!1;return $.each(b(a),function(a,b){return b.occupant&&b.occupant.name==c?(d=b.occupant,!1):void 0}),d}}]),module.filter("fleetCardNamed",["$filter",function(a){var b=a("shipCardNamed");return function(a,c){if(!a)return!1;var d=!1;return $.each(a.ships,function(a,e){return d=b(e,c),d?!1:void 0}),d}}]),module.filter("removeDashes",["$filter",function(a){return function(a){return a?a.replace(/\-/g," "):a}}]),module.factory("isMobile",function(){var a=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))}),module.controller("UtopiaCtrl",["$scope","$filter","cardLoader","$factions",function(a,b,c,d){a.search={query:"",unique:!1,generic:!1,factions:{},types:{ship:{},captain:{},admiral:{}},columns:1,sortBy:"name",ascending:"true",filterField:"",filterOperator:"<",filterValue:""};try{a.defaults=localStorage.defaults?angular.fromJson(localStorage.defaults):!1,a.defaults&&angular.copy(a.defaults.search,a.search)}catch(e){}a.defaults=a.defaults||{search:angular.copy(a.search)},a.resetSearch=function(){a.search.query="",a.search.unique=!1,a.search.generic=!1,$.each(a.search.factions,function(a,b){b.search=!1}),$.each(a.search.types,function(a,b){b.search=!1}),a.search.sortBy=a.defaults.search.sortBy||"name",a.search.ascending=a.defaults.search.ascending||"true",a.search.filterField="",a.search.filterOperator="<",a.search.filterValue=""},a.modifySearchColumns=function(b){a.search.columns+=b,a.search.columns<0&&(a.search.columns=0),a.search.columns>5&&(a.search.columns=5)},a.$watch("search",function(){a.resultLimit=10},!0),a.drag={},a.cards=[],a.sets={},a.setList=[],a.shipClasses={},a.activeFleet={ships:[]},a.loading=!0,c(a.cards,a.sets,a.shipClasses,function(){$.each(a.cards,function(b,c){a.search.types[c.type]||(a.search.types[c.type]={})});try{a.search.sets=localStorage.sets?angular.fromJson(localStorage.sets):{}}catch(b){a.search.sets={}}$.each(a.sets,function(b,c){a.search.sets[c.id]||(console.log("New set: "+c.name),a.search.sets[c.id]={search:!0}),a.setList.push(c)}),a.$broadcast("cardsLoaded"),a.loading=!1}),a.$watch("search.sets",function(a){a&&(localStorage.sets=angular.toJson(a))},!0),a.$watch("defaults",function(a){a&&(localStorage.defaults=angular.toJson(a))},!0),$.each(d.list,function(b,c){a.search.factions[c.toLowerCase().replace(/ /g,"-")]={}}),a.sortables=[{value:"name",name:"Name"},{value:"cost",name:"Cost"},{value:"attack",name:"Attack"},{value:"agility",name:"Agility"},{value:"hull",name:"Hull"},{value:"shields",name:"Shields"},{value:"skill",name:"Skill Value"}]}]),module.filter("sortBy",["$filter",function(a){return function(b,c,d){return d=d===!0||"true"==d,a("orderBy")(b,function(b){var d=a("valueOf")(b,c);return d||0},!d)}}]),module.filter("group",function(){return function(a,b){if(a){for(var c=[],d=0;d<a.length;d+=b)d+b>a.length?c.push(a.slice(d)):c.push(a.slice(d,d+b));return c}}}),module.directive("searchFilterGroup",function(){return{scope:{title:"@"},templateUrl:"search-filter-group.html",transclude:!0,link:function(a,b,c){void 0!=c.open&&(a.showContent=!0);
}}}),module.directive("card",function(){return{scope:{card:"=",ship:"=",fleet:"=",dragStore:"=",dragSource:"@"},restrict:"E",templateUrl:"card.html"}}),angular.module("utopia").run(["$templateCache",function(a){"use strict";a.put("card-faction.html",'<div class="card-outer card-faction font-staw" ng-class="{ \'dragging\': faction == dragStore.item }" draggable drag-item="faction" drag-store="dragStore" drag-source="dragSource">\r\n\r\n	<div class="card-faction-image card-faction-{{faction.factions[0]}}"></div>\r\n\r\n	<div class="card-faction-name">{{faction.name | uppercase}}</div>\r\n\r\n</div>'),a.put("card-resource.html",'<div class="card-outer card-resource font-staw" ng-class="{ \'dragging\': resource == dragStore.item }" draggable drag-item="resource" drag-store="dragStore" drag-source="dragSource">\r\n\r\n	<div class="card-resource-header">\r\n		<span class="card-title" ng-class="{\'card-title-long\': resource.name.length > 20}">{{resource.name | uppercase}}<span ng-hide="resource.hideCost"> ({{resource.cost}} SP)</span></span>\r\n	</div>\r\n\r\n	<div class="card-text">\r\n		<div class="card-text-inner font-staw-alt" ng-bind-html="resource.text | icons"></div>\r\n	</div>\r\n\r\n</div>'),a.put("card-ship.html",'<div class="card-outer card-ship font-staw" ng-class="{ \'card-unique\': ship.unique, \'card-mirror\': ship.mirror, \'dragging\': ship == dragStore.item }" draggable drag-item="ship" drag-store="dragStore" drag-source="dragSource">\r\n\r\n	<div class="card-image"></div>\r\n\r\n	<div class="card-corner-top-left pull-left"><i ng-if="ship.unique" class="card-unique-icon fs fs-unique pull-left"></i>\r\n		<div class="card-corner-inner pull-right"></div>\r\n	</div>\r\n	<div class="card-corner-top-right pull-right"><i ng-repeat="faction in ship|valueOf:\'factions\':ship:fleet" class="card-ship-faction card-faction-{{faction}} card-faction-{{$index}} fs fs-blank" ng-class="{\'card-factions-multiple\': (ship|valueOf:\'factions\':ship:fleet).length > 1}"></i>\r\n		<div class="card-corner-inner card-corner-inner-faction"></div>\r\n	</div>\r\n	<div class="card-title-container text-center">\r\n		<span class="card-title" ng-class="{\'card-title-long\': ship.name.length >= 20 }">{{ship.name | uppercase}}</span>\r\n	</div>\r\n\r\n		<div class="card-ship-stats pull-left">\r\n			<div class="card-ship-stat card-ship-stat-attack text-right"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'attack\':ship:fleet}}</div>\r\n			<div class="card-ship-stat card-ship-stat-agility text-right"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'agility\':ship:fleet}}</div>\r\n			<div class="card-ship-stat card-ship-stat-hull text-right"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'hull\':ship:fleet}}</div>\r\n			<div class="card-ship-stat card-ship-stat-shields text-right"><span class="card-skill-plus" ng-show="ship.isShipModifier">+</span>{{ship|valueOf:\'shields\':ship:fleet}}</div>\r\n		</div>\r\n\r\n		<div class="card-border-right pull-right"></div>\r\n\r\n		<div class="card-ship-silhouette pull-left"></div>\r\n\r\n		<div class="card-ship-class-container text-center">\r\n		<span class="card-ship-class" ng-class="{\'card-ship-class-long\': ship.class.length >= 25 }">{{ship.class | uppercase}}</span>\r\n	</div>\r\n\r\n	<div class="card-text font-staw-alt"><div class="card-text-inner" ng-bind-html="ship.text | icons" ng-class="{\'card-text-inner-long\': ship.text.length > 230 }"></div></div>\r\n\r\n	<div class="card-ship-action-bar text-center">\r\n		<i ng-repeat="action in ship.actions" class="fs fs-{{action}}"></i>\r\n	</div>\r\n\r\n	<div class="card-corner-bottom-right pull-right">\r\n		<div class="card-corner-inner"></div>\r\n	</div>\r\n\r\n	<div class="card-ship-cost pull-right">{{ship.cost}}</div>\r\n\r\n	<div class="card-ship-upgrade-bar">\r\n		<i ng-repeat="upgrade in ship.upgrades track by $index" class="fs fs-{{upgrade.type[0]}}" ng-class="{\'card-ship-upgrade-occupied\': upgrade.occupant}"></i>\r\n	</div>\r\n\r\n	<div style="clear: both"></div>\r\n\r\n</div>'),a.put("card-upgrade.html",'<div class="card-outer card-upgrade font-staw" ng-class="{ \'card-unique\': upgrade.unique, \'card-mirror\': upgrade.mirror, \'dragging\': upgrade == dragStore.item }" draggable drag-item="upgrade" drag-store="dragStore" drag-source="dragSource">\r\n\r\n	<div class="card-image"></div>\r\n\r\n	<div class="card-corner-top-left pull-left"><i ng-if="upgrade.unique" class="card-unique-icon fs fs-unique pull-left"></i>\r\n		<div class="card-corner-inner pull-right"></div>\r\n	</div>\r\n\r\n	<div class="card-title-container text-left">\r\n		<span ng-if="upgrade.showType" class="card-captain pull-right">{{upgrade.type|uppercase|removeDashes}}</span>\r\n		<span ng-if="upgrade.attack" class="card-weapon-attack pull-right">{{upgrade|valueOf:\'attack\':ship:fleet}}</span>\r\n		<span class="card-title" \r\n			ng-class="{ \'card-title-long\': upgrade.name.length >= 24 || (upgrade.showType && upgrade.name.length + upgrade.type.length >= 24) || (upgrade.attack && upgrade.name.length >= 20),\r\n						\'card-title-super-long\': upgrade.name.length >= 31 || upgrade.showType && upgrade.name.length + upgrade.type.length >= 31,\r\n			}">{{upgrade.name | uppercase}}</span>\r\n	</div>\r\n\r\n	<div class="card-border-left pull-left"></div>\r\n\r\n	<div class="card-text">\r\n		<div ng-if="upgrade.range" class="card-weapon-range pull-right">{{upgrade.range}}</div>\r\n		<div class="card-text-inner font-staw-alt" ng-bind-html="upgrade.text | icons" ng-class="{\'card-text-inner-long\': upgrade.text.length > 300, \'card-text-inner-super-long\': upgrade.text.length > 530 }"></div>\r\n	</div>\r\n\r\n	<div class="card-upgrade-cost pull-right"><div ng-repeat="faction in upgrade|valueOf:\'factions\':ship:fleet" class="card-upgrade-faction card-faction-{{ (upgrade|valueOf:\'factions\':ship:fleet).length - $index}}"><div class="card-upgrade-faction-black"></div><div class="card-upgrade-faction-icon card-faction-{{faction}}"></div></div><div class="card-upgrade-cost-value">{{upgrade|valueOf:\'cost\':ship:fleet}}</div></div>\r\n\r\n	<div ng-if="upgrade.type == \'captain\' || upgrade.type == \'admiral\' || (upgrade|valueOf:\'skill\':ship:fleet)" class="card-skill-container pull-left">\r\n		<div class="card-skill"><span class="card-skill-plus" ng-show="upgrade.isSkillModifier && upgrade.skill >= 0">+</span>{{upgrade|valueOf:\'skill\':ship:fleet}}</div>\r\n	</div>\r\n\r\n	<div ng-if="!(upgrade|valueOf:\'skill\':ship:fleet) && upgrade.type != \'captain\' && upgrade.type != \'admiral\' " class="card-upgrade-type pull-left fs fs-{{upgrade.type}}"></div>\r\n\r\n	<div class="card-border-bottom">\r\n		<i ng-if="upgrade.talents" ng-repeat="talent in range(upgrade.talents) track by $index" class="fs fs-talent"></i>\r\n		<i ng-repeat="slot in upgrade.upgradeSlots track by $index" ng-if="slot.showOnCard" class="fs fs-{{slot.type[0]}}" ng-class="{\'card-upgrades-long\': upgrade.upgradeSlots.length > 2}"></i>\r\n	</div>\r\n\r\n	<div style="clear: both"></div>\r\n\r\n</div>'),a.put("card.html",'<div ng-if="card" ng-switch on="card.type">\r\n	<card-ship 		ng-switch-when="ship" ship="card" drag-store="dragStore" drag-source="dragSource" fleet="fleet"></card-ship>\r\n	<card-ship 		ng-switch-when="flagship" ship="card" drag-store="dragStore" drag-source="dragSource" fleet="fleet"></card-ship>\r\n	<card-resource 	ng-switch-when="resource" resource="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-resource>\r\n	<card-faction 	ng-switch-when="faction" faction="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-faction>\r\n	<card-upgrade 	ng-switch-default upgrade="card" drag-store="dragStore" drag-source="dragSource" ship="ship" fleet="fleet"></card-upgrade>\r\n</div>'),a.put("fleet-builder.html",'<div class="fleet-open-export" ng-show="!searchOptions.showExport">\r\n	<button class="fleet-search-bigger" ng-click="searchOptions.showExport = true"><i class="fa fa-chevron-left"></i> Export</button>\r\n</div>\r\n\r\n<div class="fleet-open-search" ng-show="searchOptions.columns < 1">\r\n	<button class="fleet-search-bigger" ng-click="searchOptions.columns = 1">Search <i class="fa fa-chevron-right"></i></button>\r\n</div>\r\n\r\n<div class="fleet-ship-container" ng-repeat="ship in fleet.ships track by $index">\r\n\r\n	<div class="fleet-ship-top">\r\n		<div class="fleet-ship-top-left" ng-class="{\'fleet-ship-top-left-first\':$first}"></div>\r\n		<div class="fleet-ship-title font-staw" ng-class="{\'fleet-ship-title-long\': ship.name.length >= 18, \'fleet-ship-title-longer\': ship.name.length >= 21}">{{ ship.name }}</div>\r\n		<div class="fleet-ship-top-spacer"></div>\r\n		<div class="fleet-ship-title fleet-ship-cost font-staw">{{ getTotalCost(ship,fleet) }} SP</div>\r\n		<div class="fleet-ship-top-spacer"></div>\r\n		<div class="fleet-ship-top-spacer"></div>\r\n		<div class="toggle-button-value pull-left" ng-class="{\'toggle-button-value-active\': !ship.hideEmptySlots}"></div>\r\n		<div class="fleet-ship-title fleet-ship-cost font-staw">\r\n			<button class="title-button" ng-click="ship.hideEmptySlots = !ship.hideEmptySlots">Show Empty Slots</button>\r\n		</div>\r\n		<div class="fleet-ship-top-right"></div>\r\n	</div>\r\n	<div class="fleet-ship-middle">\r\n		<div class="fleet-ship-left"></div>\r\n		\r\n		<div class="fleet-ship-inner">\r\n\r\n			<div class="card-container">\r\n				<card card="ship" drag-store="dragStore"></card-ship>\r\n			</div><!--\r\n			Stupid whitespace breaks card alignment\r\n		 --><div class="card-container" ng-show="!ship.squadron && fleet.resource && (fleet.resource|valueOf:\'showShipResourceSlot\':ship:fleet)" droppable can-drop="$item.type == fleet.resource.slotType" drop="setShipResource(fleet,ship,$item)" drag-store="dragStore">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([fleet.resource.slotType])">\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type">\r\n							<i class="fs fs-{{fleet.resource.slotType}}"></i><br/>{{fleet.resource.slotType|removeDashes}}\r\n						</div>\r\n					</div>\r\n				</div>\r\n				<card card="ship.resource" ship="ship" fleet="fleet" drag-store="dragStore"></card>\r\n			</div><!--\r\n			\r\n		 --><div class="card-container" ng-hide="ship.squadron" droppable can-drop="$item.type == \'captain\' && $item != ship.captain" drop="setShipCaptain(fleet,ship,$item)" drag-store="dragStore">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'captain\'])">\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type">\r\n							<i class="fs fs-captain"></i><br/>Captain\r\n						</div>\r\n					</div>\r\n				</div>\r\n				<card card="ship.captain" ship="ship" fleet="fleet" drag-store="dragStore"></card>\r\n			</div><!--\r\n\r\n		 --><div class="card-container" ng-hide="!ship.admiral && ( ship.squadron || ship.hideEmptySlots || fleetHasAdmiral(fleet) )"\r\n				droppable can-drop="$item.type == \'admiral\' && $item != ship.admiral" drop="setShipAdmiral(fleet,ship,$item)" drag-store="dragStore">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'admiral\'])">\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type">\r\n							<i class="fs fs-admiral"></i><br/>Admiral\r\n						</div>\r\n					</div>\r\n				</div>\r\n				<card card="ship.admiral" ship="ship" fleet="fleet" drag-store="dragStore"></card>\r\n			</div><!--\r\n			\r\n		 --><div class="card-container" \r\n				ng-repeat="upgradeSlot in ship|upgradeSlots" ng-hide="ship.hideEmptySlots && !upgradeSlot.occupant" \r\n				droppable can-drop="isUpgradeCompatible($item, upgradeSlot, ship, fleet)" drop="setUpgrade(fleet,ship,upgradeSlot,$item)" drag-store="dragStore">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes(upgradeSlot.type)">\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type" ng-repeat="type in upgradeSlot|valueOf:\'type\':ship:fleet">\r\n							<i class="fs fs-{{type}}"></i><br/>{{type|removeDashes}}\r\n						</div>\r\n					</div>\r\n					<div ng-show="upgradeSlot.source && upgradeSlot.source != \'ship\'" class="card-drop-target-subtitle">Source: {{upgradeSlot.source}}</div>\r\n				</div>\r\n				<card card="upgradeSlot.occupant" ship="ship" fleet="fleet" drag-store="dragStore"></card>\r\n			</div>\r\n			\r\n		</div>\r\n\r\n	</div>\r\n	\r\n	<div class="fleet-ship-bottom" ng-show="$last && searchOptions.columns < 1 && !fleet.resource">\r\n		<div class="fleet-ship-bottom-left" ng-class="{\'fleet-ship-bottom-left-long\': fleet.ships.length > 0 || fleet.resource}"></div>\r\n	</div>\r\n		\r\n</div>\r\n\r\n<div class="fleet-ship-container" ng-hide="loading || ( searchOptions.columns < 1 && !fleet.resource )">\r\n\r\n	<div class="fleet-ship-top">\r\n		<div class="fleet-ship-top-left" ng-class="{\'fleet-ship-top-left-first\': fleet.ships.length == 0}"></div>\r\n		<div class="fleet-ship-title font-staw">Fleet Total</div>\r\n		<div class="fleet-ship-top-spacer"></div>\r\n		<div class="fleet-ship-title fleet-ship-cost font-staw">{{ getFleetCost(fleet) }} SP</div>\r\n		<div class="fleet-ship-top-right"></div>\r\n	</div>\r\n	\r\n	<div class="fleet-ship-middle">\r\n		<div class="fleet-ship-left"></div>\r\n		\r\n		<div class="fleet-ship-inner">\r\n\r\n			<div class="card-container" ng-hide="searchOptions.columns < 1">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'ship\'])"\r\n					droppable can-drop="$item.type == \'ship\'" drop="addFleetShip(fleet,$item)" drag-store="dragStore">\r\n					<div class="card-drop-target-title" ng-if="!isMobile">Click to search this card type</div>\r\n					<div class="card-drop-target-title" ng-if="isMobile">Tap to search this card type</div>\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type">\r\n							<i class="fs fs-ship"></i><br/>Ship\r\n						</div>\r\n					</div>\r\n					<div ng-show="!isMobile" class="card-drop-target-subtitle">Drag here to add to fleet</div>\r\n					<div ng-show="isMobile && (!dragStore.item || dragStore.item.type != \'ship\')" class="card-drop-target-subtitle">Tap a ship card to select it</div>\r\n					<div ng-show="isMobile && dragStore.item && dragStore.item.type == \'ship\'" class="card-drop-target-subtitle">Tap here to add selected ship to fleet</div>\r\n				</div>\r\n			</div><!--\r\n			\r\n			--><div class="card-container" droppable can-drop="$item.type == \'resource\' && $item != fleet.resource" drop="setFleetResource(fleet,$item)" drag-store="dragStore">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes([\'resource\'])">\r\n					<div class="card-drop-target-title"></div>\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type">\r\n							<i class="fs fs-resource"></i><br/>Resource\r\n						</div>\r\n					</div>\r\n					<div class="card-drop-target-subtitle"></div>\r\n				</div>\r\n				<card card="fleet.resource" ship="ship" fleet="fleet" drag-store="dragStore"></card>\r\n			</div><!--\r\n			\r\n			--><div class="card-container" ng-repeat="upgradeSlot in fleet.resource.upgradeSlots"\r\n				droppable can-drop="isUpgradeCompatible($item, upgradeSlot) && $item != upgradeSlot.occupant" drop="setUpgrade(fleet,fleet.resource,upgradeSlot,$item)" drag-store="dragStore">\r\n				<div class="card-outer card-drop-target font-staw" ng-click="setSearchTypes(upgradeSlot.type)">\r\n					<div class="card-drop-target-title"></div>\r\n					<div class="card-drop-target-inner">\r\n						<div class="card-drop-target-type" ng-repeat="type in upgradeSlot.type">\r\n							<i class="fs fs-{{type}}"></i><br/>{{type|removeDashes}}\r\n						</div>\r\n					</div>\r\n					<div class="card-drop-target-subtitle">{{upgradeSlot.source}}</div>\r\n				</div>\r\n				<card card="upgradeSlot.occupant" ship="ship" fleet="fleet" drag-store="dragStore"></card>\r\n			</div>\r\n			\r\n		</div>\r\n\r\n	</div>\r\n	\r\n	<div class="fleet-ship-bottom">\r\n		<div class="fleet-ship-bottom-left fleet-ship-bottom-left-long"></div>\r\n	</div>\r\n	\r\n</div>'),a.put("fleet-export.html",'<div class="fleet-close-export" ng-show="searchOptions.showExport">\r\n	<button class="fleet-search-bigger" ng-click="searchOptions.showExport = false"><i class="fa fa-chevron-right"></i> Export</button>\r\n</div>\r\n\r\n<div class="export-container">\r\n\r\n	<div class="u-search-header"><div class="u-search-header-text">Copy Text Listing</div></div>\r\n\r\n	<label class="export-option"><input type="checkbox" ng-model="showSetNames"> Include Expansion Names</label>\r\n	\r\n	<textarea class="export-text" ng-model="fleetText"></textarea>\r\n	\r\n</div>'),a.put("fleet-list.html",'<div class="container-fluid">\r\n\r\n	<div class="row" >\r\n		<div class="col-md-4">\r\n		</div>\r\n	</div>\r\n\r\n</div>'),a.put("search-filter-group.html",'<div class="u-search-header" ng-click="showContent = !showContent"><div class="u-search-header-text">{{title}}</div></div>\r\n<div class="u-search-content" ng-show="showContent" ng-transclude></div>')}]);
//# sourceMappingURL=utopia.min.js.map